/*! VersionVI: 30F180036f x */
function WDSQLRequete(n,t,i){n&&(this.m_sNomRequete=n,this.m_sSQL=t,this.m_fCallback=i,this.m_sErreurN="00000",this.m_sErreur="",this.m_nID=WDSQLRequete.prototype.ms_nIDSuivant++,this.m_tabRubriques=[])}function WDSQLRequeteWebSQL(n){if(n){WDSQLRequete.prototype.constructor.apply(this,arguments);var t=this;this.m_fCallbackTransaction=function(n){return t.__OnTransaction(n)},this.m_fCallbackExecute=function(n,i){return t.__OnExecute(n,i)},this.m_fCallbackTransactionErreur=function(n){return t.__OnErreur(n)},this.m_fCallbackExecuteErreur=function(n,i){return t.__OnErreur(i)},this.m_pclResulSet=null,this.m_nEnregistrement=-1}}function WDSQLConnexion(n){n&&(this.m_tabRequetes=[])}function WDSQLConnexionWebSQL(n){n&&(WDSQLConnexion.prototype.constructor.apply(this,arguments),this.m_oDatabase=null)}function WDSQLManager(){this.m_tabConnexions=[],this.m_tabRequetes=[],this.m_nConnexionCourante=-1,this.m_sRequeteCourante=""}WDSQLRequete.prototype.ms_nIDSuivant=0,WDSQLRequete.prototype.sGetNomRequete=function(){return this.m_sNomRequete},WDSQLRequete.prototype.nGetErreur=function(){return this.m_sErreurN},WDSQLRequete.prototype.sGetErreur=function(){return this.m_sErreur},WDSQLRequete.prototype.nGetNbRubriques=function(){return this.m_tabRubriques.length},WDSQLRequete.prototype.nGetID=function(){return this.m_nID},WDSQLRequete.prototype.tabGetTitreRubriques=function(){for(var t=this.m_tabRubriques,i=t.length,r=new Array(i),n=0;n<i;n++)r[n]=t[n].m_sNomRubrique;return r},WDSQLRequete.prototype.vbOuvre=function(){return!1},WDSQLRequete.prototype.vFerme=function(){},WDSQLRequete.prototype.vnAvance=function(){return 0},WDSQLRequete.prototype.sGetRubriqueValeur=function(n){return 0<=n&&this.m_tabRubriques.length>n?this._vsGetRubriqueValeur(n,this.m_tabRubriques[n].m_sNomRubrique):""},WDSQLRequete.prototype._vsGetRubriqueValeur=function(){return""},WDSQLRequete.prototype.sGetRubriques=function(n){for(var i=this.m_tabRubriques,f=i.length,u=[],r,t=0;t<f;t++)r=i[t].m_sNomRubrique,n&&(r+=i[t].m_bTexte?"\tT\t0\t":"\tN\t16\t"),u.push(r);return u.join("\r\n")},WDSQLRequete.prototype._RubriqueDeclare=function(n,t){this.m_tabRubriques.push({m_sNomRubrique:n,m_bTexte:t})},WDSQLRequeteWebSQL.prototype=new WDSQLRequete,WDSQLRequeteWebSQL.prototype.constructor=WDSQLRequeteWebSQL,WDSQLRequeteWebSQL.prototype.vbOuvre=function(n){return n.m_oDatabase.transaction(this.m_fCallbackTransaction,this.m_fCallbackTransactionErreur),!0},WDSQLRequeteWebSQL.prototype.vFerme=function(){this.m_pclResulSet=null,delete this.m_pclResulSet},WDSQLRequeteWebSQL.prototype.vnAvance=function(){var n=WDSQLRequete.prototype.vnAvance.apply(this,arguments);return-1==n?n:this.__bEstResultSetValide()?(-1==this.m_nEnregistrement?this.m_nEnregistrement=0:this.m_nEnregistrement++,this.__bEstPositionValide()?0:-1):-1},WDSQLRequeteWebSQL.prototype._vsGetRubriqueValeur=function(n,t){return this.__bEstResultSetValide()&&this.__bEstPositionValide()?this.m_pclResulSet.rows.item(this.m_nEnregistrement)[t]:""},WDSQLRequeteWebSQL.prototype.__bEstResultSetValide=function(){return this.m_pclResulSet&&this.m_pclResulSet.rows&&this.m_pclResulSet.rows.length},WDSQLRequeteWebSQL.prototype.__bEstPositionValide=function(){return 0<=this.m_nEnregistrement&&this.m_pclResulSet.rows.length>this.m_nEnregistrement},WDSQLRequeteWebSQL.prototype.__OnTransaction=function(n){n.executeSql(this.m_sSQL,null,this.m_fCallbackExecute,this.m_fCallbackExecuteErreur)},WDSQLRequeteWebSQL.prototype.__OnExecute=function(n,t){var i,r,u;if(this.m_pclResulSet=t,this.m_nEnregistrement=-1,this.__bEstResultSetValide()){i=this.m_pclResulSet.rows.item(0);for(r in i){u=!0;switch(typeof i[r]){case"boolean":case"number":u=!1}this._RubriqueDeclare(r,u)}}this.__AppelCallbackClient()},WDSQLRequeteWebSQL.prototype.__OnErreur=function(n){this.m_sErreurN=n.code+"",this.m_sErreur=n.message,this.__AppelCallbackClient()},WDSQLRequeteWebSQL.prototype.__AppelCallbackClient=function(){clWDSQLManagerMain.AppelCallbackClient(this,this.m_fCallback)},WDSQLConnexion.prototype.sGetDatabase=function(){return this.m_sDatabase},WDSQLConnexion.prototype.vbConnecte=function(n,t,i,r){return this.m_sDatabase=r,!0},WDSQLConnexion.prototype.vDeconnecte=function(){this.__RequeteFermeTout()},WDSQLConnexion.prototype.pclRequeteOuvre=function(n,t,i){var r=this._vpclCreeRequete(t,n,i);return r&&r.vbOuvre(this)?(this.m_tabRequetes.push(r),r):null},WDSQLConnexion.prototype._vpclCreeRequete=function(){return null},WDSQLConnexion.prototype.__RequeteFermeTout=function(){while(0<this.m_tabRequetes.length)this.__RequeteFerme(0)},WDSQLConnexion.prototype.RequeteFerme=function(n){for(var t in this.m_tabRequetes)if(this.m_tabRequetes.hasOwnProperty(t)&&this.m_tabRequetes[t]==n){this.__RequeteFerme(t);return}},WDSQLConnexion.prototype.__RequeteFerme=function(n){var t=this.m_tabRequetes[n];this.m_tabRequetes[n]=null,this.m_tabRequetes.splice(n,1),clWDSQLManagerMain.RequeteFerme(t.sGetNomRequete()),t.vFerme(),t=null},WDSQLConnexionWebSQL.prototype=new WDSQLConnexion,WDSQLConnexionWebSQL.prototype.constructor=WDSQLConnexionWebSQL,WDSQLConnexionWebSQL.prototype.vbConnecte=function(n,t,i,r){var f=WDSQLConnexion.prototype.vbConnecte.apply(this,arguments),u;return f?(u=n+(0<n.length&&0<r.length?".":"")+r,this.m_oDatabase=window.openDatabase(u,"",u,1048576),null!=this.m_oDatabase):f},WDSQLConnexionWebSQL.prototype.vDeconnecte=function(){WDSQLConnexion.prototype.vDeconnecte.apply(this,arguments),this.m_oDatabase=null},WDSQLConnexionWebSQL.prototype._vpclCreeRequete=function(n,t,i){return new WDSQLRequeteWebSQL(n,t,i)},WDSQLManager.prototype.__oCreeConnexion=function(n){switch(n.toLowerCase()){case"web sql database":case"":return window.openDatabase?new WDSQLConnexionWebSQL(!0):null;default:return null}},WDSQLManager.prototype.RequeteFerme=function(n){this.m_tabRequetes[n]&&(this.m_tabRequetes[n]=null,delete this.m_tabRequetes[n]),n==this.m_sRequeteCourante&&(this.m_sRequeteCourante="")},WDSQLManager.prototype.__nGetConnexion=function(n){return clWDUtil.nDansTableau(this.m_tabConnexions,n)},WDSQLManager.prototype.__oGetRequeteCourante=function(){return 0<this.m_sRequeteCourante.length?this.m_tabRequetes[this.m_sRequeteCourante]:null},WDSQLManager.prototype.AppelCallbackClient=function(n,t){var i=this.m_sRequeteCourante;this.m_sRequeteCourante=n.sGetNomRequete(),t(this.m_sRequeteCourante),this.m_sRequeteCourante=i};var clWDSQLManagerMain=new WDSQLManager;WDSQLManager.prototype.SQLConnecte=function(n,t,i,r,u){r===undefined&&(r=""),u===undefined&&(u="web sql database");var f=this.__oCreeConnexion(u);return f&&f.vbConnecte(n,t,i,r)?(this.m_nConnexionCourante=this.m_tabConnexions.length,this.m_tabConnexions.push(f),this.m_nConnexionCourante+1):0},WDSQLManager.prototype.SQLDeconnecte=function(){if(-1!=this.m_nConnexionCourante){var n=this.m_tabConnexions[this.m_nConnexionCourante];n.vDeconnecte(),this.m_tabConnexions[this.m_nConnexionCourante]=null,this.m_tabConnexions.splice(this.m_nConnexionCourante,1),0<this.m_nConnexionCourante?this.m_nConnexionCourante--:this.m_nConnexionCourante=0<this.m_tabConnexions.length?0:-1,n=null}return 0},WDSQLManager.prototype.SQLChangeConnexion=function(n){return(n=n-1,0<=n&&this.m_tabConnexions.length>n)?(this.m_nConnexionCourante=n,!0):!1},WDSQLManager.prototype.SQLExec=function(n,t,i){if(this.SQLFerme(t),-1!=this.m_nConnexionCourante){var r=this.m_tabConnexions[this.m_nConnexionCourante],u=r.pclRequeteOuvre(n,t,i);if(u)return this.m_tabRequetes[t]={m_oConnexion:r,m_oRequete:u},!0}return!1},WDSQLManager.prototype.SQLFerme=function(n){var t=this.m_tabRequetes[n];t&&t.m_oConnexion.RequeteFerme(t.m_oRequete)},WDSQLManager.prototype.SQLAvance=function(n){var t=this.m_tabRequetes[n];return t?t.m_oRequete.vnAvance():-1},WDSQLManager.prototype.SQLLitCol=function(n,t){var i=this.m_tabRequetes[n];return i?i.m_oRequete.sGetRubriqueValeur(t-1):""},WDSQLManager.prototype.SQLColonne=function(n,t){t===undefined&&(t=!0);var i=this.m_tabRequetes[n];return i?i.m_oRequete.sGetRubriques(t):""},WDSQLManager.prototype.SQLInfoGene=function(n){this.SQLReqExiste(n)&&(this.m_sRequeteCourante=n)},WDSQLManager.prototype.SQLReqExiste=function(n){return this.m_tabRequetes[n]?!0:!1},WDSQLManager.prototype.GetVariableRequete=function(n){var t=this.__oGetRequeteCourante();if(t)switch(n){case 0:return t.m_oConnexion.sGetDatabase();case 1:return this.__nGetConnexion(t.m_oConnexion);case 2:return t.m_oRequete.nGetErreur();case 3:return t.m_oRequete.sGetErreur();case 4:return t.m_oRequete.nGetNbRubriques();case 5:return t.m_oRequete.nGetID();case 6:return t.m_oRequete.tabGetTitreRubriques()}return 0}