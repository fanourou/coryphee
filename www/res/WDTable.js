/*! VersionVI: 30F180063c x */
function WDCacheRequete(n){this.m_oChampTable=n,this.m_oDate=new Date}function WDTableCacheLigneModifie(n){this.m_oCacheLigne=n,this.m_oCacheLigne.m_oLigneHTML.SwapLigneCache(this.m_oCacheLigne.m_nColonneHTML,this),this.m_tabValeursChaine=new Array(n.m_tabValeurs.length),this.m_tabValeursEntier=new Array(n.m_tabValeurs.length)}function WDTableCacheLigne(n,t,i){var u,e,o,s,f;if(n){this.m_sStyleCouleur=clWDAJAXMain.sXMLGetAttributSafe(n,this.XML_STYLE_COULEUR,""),this.m_sStyleCouleurFond=clWDAJAXMain.sXMLGetAttributSafe(n,this.XML_STYLE_COULEURF,""),this.m_sCleEnreg=clWDAJAXMain.sXMLGetAttributSafe(n,this.XML_CLEENREG,""),this.m_nPosAbsolue=clWDAJAXMain.nXMLGetAttributSafe(n,this.XML_LIGNE_POSABSOLUE,i),u=n.getElementsByTagName(this.XML_RUPTURES),u&&u.length&&(this.m_oValeursRuptures={},e=u[0].getElementsByTagName(this.XML_RUPTURES_HAUT),e&&e.length&&(this.m_oValeursRuptures.m_sHaut=clWDAJAXMain.sXMLGetValeur(e[0])),o=u[0].getElementsByTagName(this.XML_RUPTURES_BAS),o&&o.length&&(this.m_oValeursRuptures.m_sBas=clWDAJAXMain.sXMLGetValeur(o[0])));for(var h=n.childNodes,c=h.length-(this.m_oValeursRuptures?1:0),l=new Array(c),r=0;r<c;r++)s=h[r],f={},f.m_sStyleCouleur=clWDAJAXMain.sXMLGetAttributSafe(s,this.XML_STYLE_COULEUR,""),f.m_sStyleCouleurFond=clWDAJAXMain.sXMLGetAttributSafe(s,this.XML_STYLE_COULEURF,""),this._vPlaceXMLDansCellule(s,f,r,t),l[r]=f;this.m_tabValeurs=l}}function Segment(n,t,i){if(this.m_nDebut=n,this.m_nTaille=t,this.m_nDebut<0&&this.m_nDebut!=-1&&this.m_nTaille!=-1&&(this.m_nTaille!=0&&(this.m_nTaille+=this.m_nDebut),this.m_nDebut=0),i>=0){if(this.m_nDebut>=i){delete this.m_nDebut,delete this.m_nTaille;return}this.m_nDebut+this.m_nTaille>i&&this.m_nTaille!=0&&(this.m_nTaille=i-this.m_nDebut)}}function WDTableCache(n,t){n&&(this.RecalculeMarges(n),this.m_fCacheLigne=t,this.m_tabLignes=[],this.m_tabRequetes=[])}function WDColonne(n){this.m_bSaisissable=clWDAJAXMain.bXMLGetAttributSafe(n,this.XML_SAISISSABLE),this.m_bVisible=clWDAJAXMain.bXMLGetAttributSafe(n,this.XML_VISIBLE),this.m_sBulle=clWDAJAXMain.sXMLGetAttributSafe(n,this.XML_BULLE,null),this.m_bTri=clWDAJAXMain.bXMLGetAttributSafe(n,this.XML_TRI),this.m_bRecherche=clWDAJAXMain.bXMLGetAttributSafe(n,this.XML_RECHERCHE),this.m_nLargeur=clWDAJAXMain.nXMLGetAttributSafe(n,this.XML_LARGEUR,0),this.m_nType=clWDAJAXMain.nXMLGetAttributSafe(n,WDAJAXMain.prototype.XML_CHAMP_ATT_TYPE,WDAJAXMain.prototype.XML_CHAMP_TYPE_SAISIE);switch(this.m_nType){case WDAJAXMain.prototype.XML_CHAMP_TYPE_COMBO:this.m_tabOptions=clWDAJAXMain.tabXMLGetTableauValeur(n,"OPTION"),this.m_tabOptions||(this.m_bSaisissable=!1);break;case WDAJAXMain.prototype.XML_CHAMP_TYPE_INTERRUPTEUR:break;default:this.m_nType=WDAJAXMain.prototype.XML_CHAMP_TYPE_SAISIE;case WDAJAXMain.prototype.XML_CHAMP_TYPE_IMAGE:this.m_bSaisissable=!1;case WDAJAXMain.prototype.XML_CHAMP_TYPE_SAISIE:this.m_nLien=clWDAJAXMain.nXMLGetAttributSafe(n,this.XML_LIEN,0),this.m_nLien!=0&&(this.m_nEtatLien=clWDAJAXMain.nXMLGetAttributSafe(n,this.XML_ETATLIEN,0))}}function WDEtatLigne(n,t){if(n){this.m_oLignePhysique=n.oGetIDElement(t),this.m_nLigneHTML=t;var i,r=n.vnGetNbLignesLogiquesParLignePhysique();for(this.m_tabLignesLogiques=new Array(r),i=0;i<r;i++)this.m_tabLignesLogiques[i]={m_oLigneCache:null,m_oLigneLogique:r>1?n.oGetIDElement(t,i):this.m_oLignePhysique,m_bJamaisAffiche:!n.vbZR()||n.m_bSansLimite&&1<n.vnGetNbLignesLogiquesParLignePhysique()&&0<n.nGetNbRuptures()};this.m_tabCacheCelluleHTML=[],this.RecalculeObjetsRuptures(n,t)}}function WDEtatLignes(n,t){if(n){var i,r=t;for(this.m_tabEtatLignes=new Array(t),i=0;i<r;i++)this.m_tabEtatLignes[i]=new WDEtatLigne(n,i)}}function WDTable(n,t,i,r,u,f,e,o,s){if(n){WDChamp.prototype.constructor.apply(this,[n,undefined,undefined]),this.m_bSansLimite=t,this.m_nHauteurLigne=i,this.m_bSansLimite||(this.m_nPagesMargeMin=r,this.m_nPagesMargeMax=u,this.m_nPagesMargeRequete=parseInt((u+r)/2,10)),this.m_nTypeSelection=f,this.m_tabStyle=e;var h;if(o){this.m_tabImgTri=o;for(h in this.m_tabImgTri)this.m_tabImgTri.hasOwnProperty(h)&&((new Image).src=this.m_tabImgTri[h])}if(s){this.m_tabImgRecherche=s;for(h in this.m_tabImgRecherche)this.m_tabImgRecherche.hasOwnProperty(h)&&((new Image).src=this.m_tabImgRecherche[h])}this.m_nNbInits=0}}function WDSaisieCellule(n){if(arguments.length){this.m_oChampTable=n;var t=this;this.m_pfOnSubmit=function(n){return t.__bOnSubmit(n||event)},this.m_pfOnBlur=function(n){return t.__bOnBlur(n||event)},this.m_pfOnKeyDown=function(n){return t.__bOnKeyDown(n||event)},this.m_pfOnChange=function(n){return t.__bOnChange(n||event)}}}function WDRedimColonnes(n){n&&(WDDrag.prototype.constructor.apply(this,[0,50]),this.m_oChampTable=n)}function WDPopupSaisieRecherche(n){n&&WDPopupSaisie.prototype.constructor.apply(this,[n,!1])}if(WDCacheRequete.prototype={m_nColonneTri:-1,m_nLigne:-1,m_nIdRequeteAJAX:undefined,sCommandeAjax_LignesTable:"LIGNESTABLE",sCommandeAjax_LignesTriTable:"LIGNESTRITABLE",sCommandeAjax_ParCourtAP:"PARCOURTAP",sCommandeAjax_RechercheTable:"RECHERCHETABLE",sCommandeAjax_ModifTable:"MODIFTABLE",sParametreAjax_ColonneLien:"WD_TABLE_COL_LIEN_",sParametreAjax_Debut:"WD_TABLE_DEBUT_",sParametreAjax_Nombre:"WD_TABLE_NOMBRE_",sParametreAjax_CleEnreg:"WD_TABLE_CLEENREG_",sParametreAjax_CleEnreg_Pos:"WD_TABLE_CLEENREG_POS_",sParametreAjax_CleEnregAP:"WD_TABLE_CLEENREGAP_",sParametreAjax_CleEnregAP_Pos:"WD_TABLE_CLEENREGAP_POS_",sParametreAjax_TriAWP:"WD_TABLE_TRIAWP_",sParametreAjax_ColTri:"WD_TABLE_COL_TRI_",sParametreAjax_Recherche_Marge:"WD_TABLE_RECHERCHE_MARGE_",sParametreAjax_Recherche_Nombre:"WD_TABLE_RECHERCHE_NOMBRE_",sParametreAjax_Recherche_Col:"WD_TABLE_RECHERCHE_COL_",sParametreAjax_Recherche_Valeur:"WD_TABLE_RECHERCHE_VAL_",_sGetNomChamp:function(){return clWDEncode.sEncodePOST(this.m_oChampTable.m_sAliasChamp)},sConstuitAWP:function(n){var t=this.sConstuitPosAP(),r,i,u;return clWDAJAXMain.m_bPageAWP&&(this.m_oChampTable.m_nColonneTriePre>-1&&(t+="&"+this.sParametreAjax_TriAWP+"="+clWDEncode.sEncodePOST((this.m_oChampTable.m_bSensTriPre?"+":"-")+this.m_oChampTable.m_nColonneTriePre)),r=this.m_oChampTable.oGetElementByName(document,"_DATA"),r&&(i=r.value,i&&i.length&&(t+="&"+this._sGetNomChamp()+"_DATA="+clWDEncode.sEncodePOST(i))),n||(u=clWDAJAXMain.sConstruitValeurChamp(this.m_oChampTable.m_oChampFormulaireSelAWP),u.length&&(t+="&"+u))),t},sConstuitPosAP:function(){return this.m_oChampTable.m_sCleParcourtAP.length==0?"":"&"+this.sParametreAjax_CleEnregAP_Pos+"="+this.m_oChampTable.m_nNbLignes+"&"+this.sParametreAjax_CleEnregAP+"="+clWDEncode.sEncodePOST(this.m_oChampTable.m_sCleParcourtAP)},sConstuitRequeteRechercheTable:function(n,t,i){var r=this.sCommandeAjax_RechercheTable+"="+this._sGetNomChamp();return r+="&"+this.sParametreAjax_Recherche_Marge+"="+t,r+="&"+this.sParametreAjax_Recherche_Nombre+"="+n,r+="&"+this.sParametreAjax_Recherche_Col+"="+this.m_nColonneTri,r+="&"+this.sParametreAjax_Recherche_Valeur+"="+clWDEncode.sEncodePOST(i),r+=this.sConstuitAWP(!1)},sConstuitRequeteLignesTable:function(n,t,i){var r="";return this.m_oSegment.m_nDebut!=-1&&this.m_oSegment.m_nTaille!=-1?(r=(this.m_nColonneTri>-1?this.sCommandeAjax_LignesTriTable:this.sCommandeAjax_LignesTable)+"="+this._sGetNomChamp(),r+="&"+this.m_oSegment.m_nDebut+"="+this.m_oSegment.m_nTaille,this.m_nColonneTri>=0&&(r+="&"+this.sParametreAjax_ColTri+"="+(n?"":"-")+this.m_nColonneTri)):r=this.sCommandeAjax_ParCourtAP+"="+this._sGetNomChamp(),r+=this.sConstuitAWP(!1),i.length>0&&(r+="&"+this.sParametreAjax_CleEnreg_Pos+"="+t,r+="&"+this.sParametreAjax_CleEnreg+"="+clWDEncode.sEncodePOST(i)),r},sConstuitRequeteModifLigne:function(n,t,i){var u=this.sCommandeAjax_ModifTable+"="+this._sGetNomChamp(),f,r,e;if(u+="&LIGNE="+this.m_nLigne,i.length>0&&(u+="&"+this.sParametreAjax_CleEnreg+"="+clWDEncode.sEncodePOST(i)),u+=this.sConstuitAWP(!1),n)""!=t&&(u+="&"+t);else{for(f=new Array(t.length),e=t.length,r=0;r<e;r++)f[r]=t[r].m_nValeur!==undefined&&t[r].m_nValeur!==-1?"C"+r+"="+t[r].m_nValeur:"C"+r+"="+clWDEncode.sEncodePOST(t[r].m_sValeur);u+="&"+f.join("&")}return u},sConstuitRequeteSelection:function(n,t,i,r){var u=this.sParametreAjax_Debut+"="+t+"&"+this.sParametreAjax_Nombre+"="+i;return u+="&"+this.sParametreAjax_ColonneLien+"="+(n!=-1?n+1:""),r.length>0&&(u+="&"+this.sParametreAjax_CleEnreg+"="+clWDEncode.sEncodePOST(r)),u+=this.sConstuitAWP(!0)},sConstuitRequeteEnrouleDeroule:function(){return this.sConstuitAWP(!1)},bEnvoiRequete:function(n,t){var i=n.apply(this,t);return i!==!1?(this.m_nIdRequeteAJAX=i,!0):!1},nEnvoiRequete:function(n,t,i,r,u){return this.m_oSegment=n,this.m_nColonneTri=t,clWDAJAXMain.nAJAXRecupereLignesTable(this,this.sConstuitRequeteLignesTable(i,r,u))},nEnvoiRequeteRecherche:function(n,t,i,r){return this.m_nColonneTri=i,clWDAJAXMain.nAJAXRecupereLignesTable(this,this.sConstuitRequeteRechercheTable(n,t,r))},nEnvoiRequeteModifLigne:function(n,t,i,r){return this.m_nLigne=n,clWDAJAXMain.nAJAXRecupereLignesTable(this,this.sConstuitRequeteModifLigne(t,i,r))},nEnvoiRequeteSelection:function(n,t,i,r){var u=n!=-1?this.m_oChampTable.nColonneLien(n)==2:!1;return clWDAJAXMain.nAJAXRecupereLignesTableSelection(this,this.sConstuitRequeteSelection(n,t,i,r),u)},nEnvoiRequeteEnrouleDeroule:function(n){return clWDAJAXMain.nAJAXRecupereLignesTableEnrouleDeroule(this,n,this.sConstuitRequeteEnrouleDeroule())},ActionListe:function(n){if(this.m_oChampTable){var t=this.m_oChampTable;this.SupprimeRequete(!1),t.bActionListeDepuisAJAX(n,this.m_nLigne)}},bEstValide:function(){return+new Date-this.m_oDate.getTime()<=1e4},SupprimeRequete:function(n){var t=this.m_oChampTable;undefined!=t&&(t.m_oCache.SupprimeRequete(this),n&&t.nSetTimeoutUnique("Reinit",2e3))}},WDTableCacheLigneModifie.prototype.bLigneVirtuelle=!0,WDTableCacheLigneModifie.prototype.vnGetLigneHTML=function(){return this.m_oCacheLigne.vnGetLigneHTML.apply(this.m_oCacheLigne,arguments)},WDTableCacheLigneModifie.prototype.vnGetColonneHTML=function(){return this.m_oCacheLigne.vnGetColonneHTML.apply(this.m_oCacheLigne,arguments)},WDTableCacheLigneModifie.prototype.sGetCellule=function(n,t){return this.m_tabValeursChaine[n]?t?this.m_tabValeursEntier[n]:this.m_tabValeursChaine[n]:this.m_oCacheLigne.sGetCellule.apply(this.m_oCacheLigne,arguments)},WDTableCacheLigneModifie.prototype.tabContenuCellule=function(){return this.m_oCacheLigne.tabContenuCellule.apply(this.m_oCacheLigne,arguments)},WDTableCacheLigneModifie.prototype.sGetCleEnreg=function(){return this.m_oCacheLigne.sGetCleEnreg.apply(this.m_oCacheLigne,arguments)},WDTableCacheLigneModifie.prototype.vbMAJLigne=function(n,t,i,r){return this.m_oCacheLigne.vbMAJLigne.apply(this.m_oCacheLigne,[n,t,this.m_tabValeursChaine,r])},WDTableCacheLigneModifie.prototype.DetacheEtVide=function(n){this.m_oCacheLigne.DetacheEtVide(n)},WDTableCacheLigneModifie.prototype.ChangementValeur=function(n,t,i){n<this.m_tabValeursChaine.length&&(this.m_tabValeursChaine[n]=t,this.m_tabValeursEntier[n]=i)},WDTableCacheLigneModifie.prototype.ValideChangement=function(n,t,i){for(var f=!1,u=this.m_tabValeursChaine,e=this.m_tabValeursEntier,o=u.length,r=0;r<o;r++)u[r]!==undefined&&(f|=this.m_oCacheLigne.bChangementValeur(r,u[r],e[r]));f&&t.CreeRequeteModifLigne(n,i,!1,this.m_oCacheLigne.m_tabValeurs)},WDTableCacheLigneModifie.prototype.SetHauteur=function(){return this.m_oCacheLigne.SetHauteur.apply(this.m_oCacheLigne,arguments)},WDTableCacheLigneModifie.prototype.nGetHauteur=function(){return this.m_oCacheLigne.nGetHauteur.apply(this.m_oCacheLigne,arguments)},WDTableCacheLigneModifie.prototype.SetStyle=function(){return this.m_oCacheLigne.SetStyle.apply(this.m_oCacheLigne,arguments)},WDTableCacheLigne.prototype.XML_STYLE_COULEUR="COULEUR",WDTableCacheLigne.prototype.XML_STYLE_COULEURF="COULEURFOND",WDTableCacheLigne.prototype.XML_CLEENREG="CLEENREG",WDTableCacheLigne.prototype.XML_LIGNE_POSABSOLUE="POSABSOLUE",WDTableCacheLigne.prototype.XML_RUPTURES="RUPTURES",WDTableCacheLigne.prototype.XML_RUPTURES_HAUT="HAUT",WDTableCacheLigne.prototype.XML_RUPTURES_BAS="BAS",WDTableCacheLigne.prototype.m_oVide={m_sValeur:"",m_sStyleCouleur:"",m_sStyleCouleurFond:"",m_nValeur:-1,m_sCleEnreg:""},WDTableCacheLigne.prototype.m_nValeur=-1,WDTableCacheLigne.prototype.m_nHauteur=-1,WDTableCacheLigne.prototype._vPlaceXMLDansCellule=function(n,t,i,r){var u,f;t.m_sValeur=clWDAJAXMain.sXMLGetValeur(n);switch(r.nColonneType(i)){case WDAJAXMain.prototype.XML_CHAMP_TYPE_COMBO:u=clWDAJAXMain.tabXMLGetTableauValeur(n,"OPTION"),u||(u=r.tabColonneCombo(i)),t.m_tabOptions=u,u?(f=clWDUtil.nDansTableau(u,t.m_sValeur),clWDUtil.nElementInconnu!=f&&(t.m_nValeur=f)):t.m_nValeur=-1;break;case WDAJAXMain.prototype.XML_CHAMP_TYPE_INTERRUPTEUR:t.m_nValeur=parseInt(t.m_sValeur,10)}},WDTableCacheLigne.prototype.vnGetLigneHTML=function(n){return n},WDTableCacheLigne.prototype.vnGetColonneHTML=function(){return 0},WDTableCacheLigne.prototype.vnGetNbReplieesOuEnroulees=function(){return 0},WDTableCacheLigne.prototype.sGetCellule=function(n,t){var i=n<this.m_tabValeurs.length?this.m_tabValeurs[n]:this.m_oVide;return t?i.m_nValeur:i.m_sValeur},WDTableCacheLigne.prototype.tabContenuCellule=function(n){return this.m_tabValeurs[n].m_tabOptions},WDTableCacheLigne.prototype.sGetCleEnreg=function(){return this.m_sCleEnreg},WDTableCacheLigne.prototype.vbMAJLigne=function(n,t,i,r){var h=n.vbLigneEstSelectionneeSansZR(t),e,c,o,s;if(!this.m_oLigneHTML)return!1;e=this.vnGetColonneHTML(),c=this.m_oLigneHTML.oGetLigneLogiqueHTML(e),this.SetCouleurObjet(n.m_sCSSTexteStyleSelectionCouleurFond,c,h,this);for(var l=this.m_tabValeurs,f=-1,a=l.length,u;(u=this.m_oLigneHTML.oGetCellule(e,++f,n))||f<a;)u&&(o=f<a?l[f]:this.m_oVide,s=o.m_sValeur,i&&undefined!==i[f]&&(s=i[f]),n.vRemplitCellule(u,s,t,f,this,r),u=u.parentNode,!n.vbZR()&&n.bGetHauteurLigneVariable()&&(u=u.parentNode),this.SetCouleurObjet(n.m_sCSSTexteStyleSelectionCouleurFond,u,h,o));return n.RemplitRuptures(this.m_oLigneHTML,e,this.m_oValeursRuptures),!0},WDTableCacheLigne.prototype.DetacheEtVide=function(n){this.m_oLigneHTML&&this.m_oLigneHTML.DetacheEtVide(this.m_nColonneHTML,n)},WDTableCacheLigne.prototype.ChangementValeur=function(){},WDTableCacheLigne.prototype.SetCouleurObjet=function(n,t,i,r){var f=r.m_sStyleCouleurFond,u;i&&undefined!=n&&(f=n),u=t.style,u.color!=r.m_sStyleCouleur&&(u.color=r.m_sStyleCouleur),u.backgroundColor!=f&&(u.backgroundColor=f)},WDTableCacheLigne.prototype.bChangementValeur=function(n,t,i){var r=this.m_tabValeurs;return n<r.length&&!(r[n].m_sValeur===t)?(r[n].m_sValeur=t,r[n].m_nValeur=i,!0):!1},WDTableCacheLigne.prototype.SetHauteur=function(n){this.m_nHauteur=n},WDTableCacheLigne.prototype.nGetHauteur=function(){return this.m_nHauteur},WDTableCacheLigne.prototype.SetStyle=function(n,t,i,r,u){this.m_oLigneHTML&&(this.m_oLigneHTML.SetStyle(t,this.m_nColonneHTML,n),t.vbZR()||this.m_oLigneHTML.bMAJSiPlein(this.m_nColonneHTML,t,i,r,u))},Segment.prototype.m_nDebut=-1,Segment.prototype.m_nTaille=0,Segment.prototype.bIntersecte=function(n){return this.m_nDebut==-1||this.m_nTaille<=0?!0:n&&n.m_nTaille==0?(delete this.m_nDebut,delete this.m_nTaille,!0):!n||n.m_nDebut==-1||n.m_nTaille<=0?!1:this.m_nDebut>=n.m_nDebut&&this.m_nDebut+this.m_nTaille<=n.m_nDebut+n.m_nTaille?(delete this.m_nDebut,delete this.m_nTaille,!0):this.m_nDebut<n.m_nDebut&&this.m_nDebut+this.m_nTaille>n.m_nDebut?(this.m_nTaille=n.m_nDebut-this.m_nDebut,!1):this.m_nDebut>=n.m_nDebut&&this.m_nDebut<n.m_nDebut+n.m_nTaille&&this.m_nDebut+this.m_nTaille>n.m_nDebut+n.m_nTaille?(this.m_nTaille-=n.m_nDebut+n.m_nTaille-this.m_nDebut,this.m_nDebut=n.m_nDebut+n.m_nTaille,!1):!1},Segment.prototype.bEstVide=function(){return this.m_nTaille<0||this.m_nDebut<0&&this.m_nDebut+this.m_nTaille<=0},WDTableCache.prototype.m_nDebutCache=-1,WDTableCache.prototype.XML_LIGNE="LIGNE",WDTableCache.prototype.XML_LIGNE_NUMERO="NUMERO",WDTableCache.prototype.RecalculeMarges=function(n){var t=n.m_nNbLignesPage;if(0!=t){var i=n.m_nPagesMargeMin,r=n.m_nPagesMargeMax,u=n.m_nPagesMargeRequete;this.m_nLignesMargeMinAvant=i*t,this.m_nLignesMargeMinTaille=(i*2+1)*t+2,this.m_nLignesMargeMaxAvant=r*t,this.m_nLignesMargeMaxApres=(r+1)*t+2,this.m_nLignesMargeRequeteAvant=Math.min(u*t,this.m_nLignesMargeMaxAvant),this.m_nLignesMargeRequeteTaille=Math.min((u*2+1)*t+2,this.m_nLignesMargeMaxAvant+this.m_nLignesMargeMaxApres)}},WDTableCache.prototype.RemplitCache=function(n,t,i,r){var u,s,e,h,c,l,f,o;if(i>-1&&(this.m_tabLignes.length=0,delete this.m_nDebutCache),s=n.m_nNbLignesPage,e=n.m_nDebut,0==s)u=new Segment(0,0);else if(h=n.m_nNbLignes,c=new Segment(Math.max(0,e-this.m_nLignesMargeMinAvant),this.m_nLignesMargeMinTaille,t?-1:h),u=new Segment(Math.max(0,e-this.m_nLignesMargeRequeteAvant),this.m_nLignesMargeRequeteTaille,t?-1:h+this.m_nLignesMargeMinTaille),this.m_nDebutCache!=-1&&!t){if(l=new Segment(Math.max(0,this.m_nDebutCache),this.m_tabLignes.length),c.bIntersecte(l))return;if(this.bIntersecteAnciennesRequetes(c,i>-1))return;u.bIntersecte(l)}this.bIntersecteAnciennesRequetes(u,i>-1)||(f=-1,o="",clWDAJAXMain.m_bPageAWP&&(this.m_nDebutCache>=0&&0!=s&&(f=this.m_nDebutCache<u.m_nDebut?Math.min(this.m_nDebutCache+this.m_tabLignes.length-1,u.m_nDebut-1):Math.max(this.m_nDebutCache,u.m_nDebut+u.m_nTaille),o=this.sGetCleEnregLigne(f)),-1<e&&n.m_sCleDebut&&(f==-1||Math.abs(e-u.m_nDebut)<Math.abs(e-f))&&(f=e,o=n.m_sCleDebut)),this.CreeRequete(n,u,i,r,f,o))},WDTableCache.prototype.bIntersecteAnciennesRequetes=function(n,t){this.PurgeAnciennesRequetes(t);for(var r=this.m_tabRequetes.length,i=0;i<r;i++)if(n.bIntersecte(this.m_tabRequetes[i].m_oSegment))return!0;return n.bEstVide()},WDTableCache.prototype.bEnvoiRequete=function(n,t,i){var r=new WDCacheRequete(t);return r.bEnvoiRequete(n,i)?(this.m_tabRequetes.push(r),!0):!1},WDTableCache.prototype.CreeRequete=function(n,t,i,r,u,f){this.bEnvoiRequete(WDCacheRequete.prototype.nEnvoiRequete,n,[t,i,r,u,f])},WDTableCache.prototype.CreeRequeteRecherche=function(n,t,i){this.bEnvoiRequete(WDCacheRequete.prototype.nEnvoiRequeteRecherche,n,[n.m_nNbLignesPage,this.m_nLignesMargeRequeteAvant?this.m_nLignesMargeRequeteAvant:0,t,i])},WDTableCache.prototype.CreeRequeteModifLigne=function(n,t,i,r){this.bEnvoiRequete(WDCacheRequete.prototype.nEnvoiRequeteModifLigne,n,[t,i,r,this.sGetCleEnregLigne(t)])},WDTableCache.prototype.CreeRequeteSelection=function(n,t){this.bEnvoiRequete(WDCacheRequete.prototype.nEnvoiRequeteSelection,n,[t,this.m_nDebutCache,this.m_tabLignes.length,this.sGetCleEnregLigne(this.m_nDebutCache)])},WDTableCache.prototype.CreeRequeteEnrouleDeroule=function(n,t){this.bEnvoiRequete(WDCacheRequete.prototype.nEnvoiRequeteEnrouleDeroule,n,[t,this.sGetCleEnregLigne(t)])},WDTableCache.prototype.sGetCleEnregLigne=function(n){if(this.bDansPlageCache(n)){var t=this.m_tabLignes[n-this.m_nDebutCache];if(t)return t.sGetCleEnreg()}return""},WDTableCache.prototype.PurgeAnciennesRequetes=function(n){for(var r=this.m_tabRequetes.length,i,t=0;t<r;t++)(this.m_tabRequetes[t].bEstValide()==!1||n)&&(delete this.m_tabRequetes[t].m_oChampTable,i=clWDAJAXMain.GetWDAJAXRequete(this.m_tabRequetes[t].m_nIdRequeteAJAX),i!=null&&i.Annule(),delete i,this.m_tabRequetes.splice(t,1),t--,r--)},WDTableCache.prototype.SupprimeRequete=function(n){for(var i=this.m_tabRequetes.length,t=0;t<i;t++)if(this.m_tabRequetes[t].m_oDate.getTime()==n.m_oDate.getTime()&&this.m_tabRequetes[t].m_nIdRequeteAJAX==n.m_nIdRequeteAJAX){delete this.m_tabRequetes[t].m_oChampTable,this.m_tabRequetes.splice(t,1);return}},WDTableCache.prototype.bAvecRequeteTri=function(){for(var t=this.m_tabRequetes.length,n=0;n<t;n++)if(this.m_tabRequetes[n].m_nColonneTri>-1)return!0;return!1},WDTableCache.prototype.__nPlaceLigneCache=function(n,t){var u,i,r;if(n.m_nNbLignesPage>0&&(u=n.m_nDebut,t<u-this.m_nLignesMargeMaxAvant||t>=u+this.m_nLignesMargeMaxApres))return-1;if(this.m_nDebutCache==-1)return this.m_tabLignes.push(null),this.m_nDebutCache=t,0;if(t<this.m_nDebutCache){for(r=this.m_nDebutCache-t,i=0;i<r;i++)this.m_tabLignes.unshift(null);return this.m_nDebutCache=t,0}if(t>=this.m_nDebutCache+this.m_tabLignes.length)for(r=t-this.m_nDebutCache-this.m_tabLignes.length+1,i=0;i<r;i++)this.m_tabLignes.push(null);else t-this.m_nDebutCache<this.m_tabLignes.length&&this.m_tabLignes[t-this.m_nDebutCache]!=null&&(delete this.m_tabLignes[t-this.m_nDebutCache].m_tabValeurs,this.m_tabLignes[t-this.m_nDebutCache]=null);return t-this.m_nDebutCache},WDTableCache.prototype.RemplitCacheLignes=function(n,t){for(var o=this.bDansPlageCache(n.m_nDebut),r=t.firstChild,u,i,f,e;r!=null;){if(u=parseInt(clWDAJAXMain.sXMLGetAttribut(r,this.XML_LIGNE_NUMERO),10),i=this.__nPlaceLigneCache(n,u),i!=-1){if(this.m_tabLignes[i]=new this.m_fCacheLigne(r,n,u),f=this.m_tabLignes[i].vnGetNbReplieesOuEnroulees(),0<f)for(e=this.m_tabLignes[i].m_nPosAbsolue+f;this.m_tabLignes[i+1]&&this.m_tabLignes[i+1].m_nPosAbsolue<=e;)this.m_tabLignes.splice(i+1,1);o&&n.NoteMAJLigne(u)}r=r.nextSibling}},WDTableCache.prototype.SupprimeLignesInutiles=function(n){var t,i;if(this.m_nDebutCache!=-1){if(t=this.m_tabLignes,0==n.m_nNbLignesPage){t.length>n.m_nNbLignes&&t.splice(n.m_nNbLignes);return}if(i=n.m_nDebut,this.m_nDebutCache+t.length<=i-this.m_nLignesMargeMaxAvant||this.m_nDebutCache>=i+this.m_nLignesMargeMaxApres){t.length=0,delete this.m_nDebutCache;return}for(this.m_nDebutCache<i-this.m_nLignesMargeMaxAvant&&(t.splice(0,i-this.m_nLignesMargeMaxAvant-this.m_nDebutCache),this.m_nDebutCache=i-this.m_nLignesMargeMaxAvant),this.m_nDebutCache+t.length>=i+this.m_nLignesMargeMaxApres&&t.splice(i-this.m_nDebutCache+this.m_nLignesMargeMaxApres),this.m_nDebutCache+t.length>n.m_nNbLignes&&t.splice(n.m_nNbLignes-this.m_nDebutCache);t.length&&!t[0];)t.splice(0,1),this.m_nDebutCache++;while(t.length&&!t[t.length-1])t.splice(t.length-1,1);0==t.length&&delete this.m_nDebutCache}},WDTableCache.prototype.oGetLigne=function(n){return this.bDansPlageCache(n)?this.m_tabLignes[n-this.m_nDebutCache]:null},WDTableCache.prototype.bMAJLigne=function(n,t,i){var r=this.oGetLigne(t);return r?r.vbMAJLigne(n,t,undefined,i):!1},WDTableCache.prototype.tabContenuCellule=function(n,t){var i=this.oGetLigne(n);return i?i.tabContenuCellule(t):null},WDTableCache.prototype.sGetCellule=function(n,t,i){var r=this.oGetLigne(n);return r?r.sGetCellule(t,i):i?-1:""},WDTableCache.prototype.bDansPlageCache=function(n){return n>=this.m_nDebutCache&&n<this.m_nDebutCache+this.m_tabLignes.length},WDTableCache.prototype.ChangementValeur=function(n,t,i,r,u){if(this.m_nDebutCache!=-1){var f=n-this.m_nDebutCache;f<=this.m_tabLignes.length&&this.m_tabLignes[f]!=null&&this.m_tabLignes[f].ChangementValeur(i,r,u)}},WDTableCache.prototype.ValideChangement=function(n,t){var i=this.m_tabLignes[t-this.m_nDebutCache];i&&i.bLigneVirtuelle&&i.ValideChangement(n,this,t)},WDTableCache.prototype.SupprimeLignesVirtuelles=function(){for(var i=this.m_tabLignes.length,n,t=0;t<i;t++)n=this.m_tabLignes[t],n&&n.bLigneVirtuelle&&(this.m_tabLignes[t]=n.m_oCacheLigne,n.m_oCacheLigne.m_oLigneHTML.SwapLigneCache(n.m_oCacheLigne.m_nColonneHTML,n.m_oCacheLigne),delete n.m_oCacheLigne,delete n.m_tabValeurs,delete n)},WDTableCache.prototype.bCreeLigneVirtuelle=function(n){var t=n-this.m_nDebutCache;return this.m_tabLignes[t]?(this.m_tabLignes[t].bLigneVirtuelle||(this.m_tabLignes[t]=new WDTableCacheLigneModifie(this.m_tabLignes[t])),!0):!1},WDTableCache.prototype.SetHauteur=function(n,t){var i=this.oGetLigne(n);if(i){i.SetHauteur(t);return}},WDTableCache.prototype.nGetHauteur=function(n){var t=this.oGetLigne(n);return t?t.nGetHauteur():-1},WDTableCache.prototype.nPosAbsolue2PosVisible=function(n){var t,r,i;if(this.m_tabLignes.length==0||n<this.m_tabLignes[0].m_nPosAbsolue||n>this.m_tabLignes[this.m_tabLignes.length-1].m_nPosAbsolue)return n;for(r=this.m_tabLignes.length,t=0;t<r;t++)if(i=this.m_tabLignes[t],i&&i.m_nPosAbsolue==n)return t+this.m_nDebutCache;return n},WDTableCache.prototype.nPosVisible2PosAbsolue=function(n){if(this.m_tabLignes.length==0)return n;var t=this.oGetLigne(n);return t?t.m_nPosAbsolue:n},WDColonne.prototype.m_nLien=0,WDColonne.prototype.m_nEtatLien=0,WDColonne.prototype.m_tabOptions=[],WDColonne.prototype.XML_SAISISSABLE="SAISISSABLE",WDColonne.prototype.XML_VISIBLE="VISIBLE",WDColonne.prototype.XML_LIEN="LIEN",WDColonne.prototype.XML_ETATLIEN="ETATLIEN",WDColonne.prototype.XML_BULLE="BULLE",WDColonne.prototype.XML_TRI="TRI",WDColonne.prototype.XML_RECHERCHE="RECHERCHE",WDColonne.prototype.XML_LARGEUR="LARGEUR",WDEtatLigne.prototype.oGetLigneLogique=function(n){return this.m_tabLignesLogiques[n]},WDEtatLigne.prototype.oGetLigneLogiqueHTML=function(n){return this.m_tabLignesLogiques[n].m_oLigneLogique},WDEtatLigne.prototype.oGetCellule=function(n,t,i){var r;if(this.m_tabLignesLogiques.length<=1)r=t;else if(t==0)r=n;else return null;return this.oGetCelluleHTML(i,r)},WDEtatLigne.prototype.RecalculeObjetsRuptures=function(n,t){n.nGetNbRuptures()>0&&(this.m_oRupturesHaut=n.oGetIDElement(WDTable.prototype.ID_RUPTURE_HAUT,t),this.m_oRupturesBas=n.oGetIDElement(WDTable.prototype.ID_RUPTURE_BAS,t))},WDEtatLigne.prototype.nInvalide=function(n,t,i,r){for(var f=this.m_tabLignesLogiques.length,u=0;u<f;u++)(this.bPlein(u)||i)&&(this.MasqueLigne(u,n,t,r,t%2==0?n.m_tabStyle[0]:n.m_tabStyle[1]),t++);return t},WDEtatLigne.prototype.SwapLigneCache=function(n,t){this.m_tabLignesLogiques[n].m_oLigneCache=t},WDEtatLigne.prototype.SetStyle=function(n,t,i){var r=this.oGetLigneLogiqueHTML(t);n.vbZR()&&(r=1<n.vnGetNbLignesLogiquesParLignePhysique()?r.parentNode:r.firstChild),r.className=i},WDEtatLigne.prototype.bPlein=function(n){return this.m_tabLignesLogiques[n].m_oLigneCache?!0:!1},WDEtatLigne.prototype.bJamaisAffiche=function bJamaisAffiche(n){var bJamaisAffiche=this.m_tabLignesLogiques[n].m_bJamaisAffiche;return bJamaisAffiche&&(this.m_tabLignesLogiques[n].m_bJamaisAffiche=!1),bJamaisAffiche},WDEtatLigne.prototype.bMAJSiPlein=function(n,t,i,r,u){var f=this.m_tabLignesLogiques[n].m_oLigneCache;return f?this.bMAJ(n,f,t,i,r,u):!1},WDEtatLigne.prototype.bMAJ=function(n,t,i,r,u,f){var e;return t?(this.AfficheLigne(n,t,i,r,u),e=t.vbMAJLigne(i,r,undefined,f)):(this.MasqueLigne(n,i,r,u),e=!0),i.vPostMAJLigne(r,u),e},WDEtatLigne.prototype.DetacheEtVide=function(n,t){this.Detache(n),t.vVideCellule(this,n)},WDEtatLigne.prototype.Detache=function(n){this.DetacheO(this.m_tabLignesLogiques[n])},WDEtatLigne.prototype.DetacheO=function(n){n.m_oLigneCache&&(delete n.m_oLigneCache.m_oLigneHTML,delete n.m_oLigneCache.m_nColonneHTML,n.m_oLigneCache=null)},WDEtatLigne.prototype.AfficheLigne=function(n,t,i,r,u){i.vPreMAJLigne(r,u);var f=this.m_tabLignesLogiques[n];f.m_oLigneCache!=t&&(this.DetacheO(f),t.DetacheEtVide(i),f.m_oLigneCache=t,t.m_oLigneHTML=this,t.m_nColonneHTML=n),f.m_oLigneLogique.style.visibility="inherit",this.vAfficheLigne(i)},WDEtatLigne.prototype.MasqueLigne=function(n,t,i,r,u){t.vPreMAJLigne(i,r);var f=this.m_tabLignesLogiques[n];this.DetacheO(f),t.vVideCellule(this,n),n==0&&t.VideRuptures(this),t.vbZR()?f.m_oLigneLogique.style.visibility="hidden":undefined!==u&&this.SetStyle(t,n,u),clWDUtil.bBaliseEstTag(f.m_oLigneLogique.parentNode,"td")&&(f.m_oLigneLogique.parentNode.style.backgroundColor="transparent"),clWDUtil.bBaliseEstTag(f.m_oLigneLogique,"tr")&&(f.m_oLigneLogique.style.backgroundColor=""),this.vAfficheLigne(t)},WDEtatLigne.prototype.vAfficheLigne=function(n){n.vbZR()?(this.m_oLignePhysique.style.visibility=this.m_tabLignesLogiques[0].m_oLigneCache?"inherit":"hidden",n.m_bSansLimite&&1<n.vnGetNbLignesLogiquesParLignePhysique()&&0<n.nGetNbRuptures()&&clWDUtil.SetDisplay(this.m_oLignePhysique,undefined!=this.m_tabLignesLogiques[0].m_oLigneCache)):this.m_oLignePhysique.style.visibility=""},WDEtatLigne.prototype.oGetCelluleHTML=function(n,t){var i=this.m_tabCacheCelluleHTML[t];return i?i:(i=n.oGetIDElement(this.m_nLigneHTML,t),this.m_tabCacheCelluleHTML[t]=i,i)},WDEtatLigne.prototype.tabGetCelluleHTMLCache=function(){return this.m_tabCacheCelluleHTML},WDEtatLignes.prototype.RecalculeObjetsRuptures=function(n){for(var i=this.m_tabEtatLignes.length,t=0;t<i;t++)this.m_tabEtatLignes[t].RecalculeObjetsRuptures(n,t)},WDEtatLignes.prototype.Invalide=function(n,t,i,r,u){for(var e=this.m_tabEtatLignes.length,f=i;f<e;f++)t=this.m_tabEtatLignes[f].nInvalide(n,t,r,u)},WDEtatLignes.prototype.nGetNbEtatLignes=function(){return this.m_tabEtatLignes.length},WDEtatLignes.prototype.oGetEtatLigne=function(n){return this.m_tabEtatLignes[n]},WDEtatLignes.prototype.oGetCelluleHTML=function(n,t,i){return this.oGetEtatLigne(t).oGetCelluleHTML(n,i)},WDTable.prototype=new WDChamp,WDTable.prototype.constructor=WDTable,WDTable.prototype.m_nFacteurAscenseur=1,WDTable.prototype.m_nLimiteHauteur=bIE?nIE>=8?1342177:134217727:71582788,WDTable.prototype.m_bRequeteDiffereeForce=!1,WDTable.prototype.m_nColonneTrie=-1,WDTable.prototype.m_nColonneTriePre=-1,WDTable.prototype.m_bSensTri=!0,WDTable.prototype.m_bSensTriPre=!0,WDTable.prototype.m_nColonneRecherche=-1,WDTable.prototype.m_bFinTrouve=!1,WDTable.prototype.m_sCleParcourtAP="",WDTable.prototype.m_bRetourServeurSelection=!0,WDTable.prototype.m_bMasqueVisible=!1,WDTable.prototype.m_bHauteurLigneVariable=!0,WDTable.prototype.m_nNbRuptures=0,WDTable.prototype.XML_NOMBRE="NOMBRE",WDTable.prototype.XML_FIN="FIN",WDTable.prototype.XML_DEBUT="DEBUT",WDTable.prototype.XML_CLEENREGAP="CLEENREGAP",WDTable.prototype.XML_SELECTIONS="SELECTIONS",WDTable.prototype.XML_COLONNES="COLONNES",WDTable.prototype.XML_LIGNES="LIGNES",WDTable.prototype.XML_SELECTION="SELECTION",WDTable.prototype.XML_COLONNE="COLONNE",WDTable.prototype.XML_ERREUR="ERREUR",WDTable.prototype.XML_TRI="TRI",WDTable.prototype.XML_SENS="SENS",WDTable.prototype.XML_DESACTIVESERSEL="DESACTIVESERSEL",WDTable.prototype.XML_HAUTEURLIGNEVARIABLE="HAUTEURLIGNEVARIABLE",WDTable.prototype.XML_COLHIERARCHIQUE="COLHIERARCHIQUE",WDTable.prototype.SELECTION_SANS=0,WDTable.prototype.SELECTION_SIMPLE=1,WDTable.prototype.SELECTION_MULTIPLE=2,WDTable.prototype.ID_SCROLLBAR="SB",WDTable.prototype.ID_TABLEINTERNE="TB",WDTable.prototype.ID_POSITION_PIXEL="POS",WDTable.prototype.ID_CHARGEMENT_IMG="LOAD",WDTable.prototype.ID_MASQUE="MASQUE",WDTable.prototype.ID_MASQUETRANSPARENT="MASQUETR",WDTable.prototype.ID_TITRE="TITRES",WDTable.prototype.ID_TRI="TRI",WDTable.prototype.ID_RECHERCHE="RECH",WDTable.prototype.ID_RUPTURE_HAUT="H",WDTable.prototype.ID_RUPTURE_BAS="B",WDTable.prototype.SEL_SEPARATEUR=";",WDTable.prototype.vCacheLigne=WDTableCacheLigne,WDTable.prototype.Init=function(n,t){var u,h,f,r,e,c,o,s,l,i;WDChamp.prototype.Init.apply(this,[]),this.__CreeStyleLigneSelectionne(),this.m_oDivPos=this.oGetIDElement(this.ID_POSITION_PIXEL),this.m_oMasque=this.oGetIDElement(this.ID_MASQUE),this.m_oMasqueTransparent=this.oGetIDElement(this.ID_MASQUETRANSPARENT),u=this.oGetIDElement(this.ID_TITRE,this.ID_POSITION_PIXEL),u&&(h=this.m_oDivPos,this.m_oDivPos.parentNode.onscroll=function(){u.parentNode.scrollLeft=h.parentNode.scrollLeft}),this.AfficheMasques(),f=this,this.m_oDivPos.parentNode.onresize=function(){f.__RedimensionneMasques()},this.m_bSansLimite||(this.m_fScroll=function(n){f.DeplaceTable(n||event)},this.m_oAscenseur=this.oGetIDElement(this.ID_SCROLLBAR),this.m_oAscenseurParent=this.m_oAscenseur.parentNode,this.InitForceDefilement(this.m_oDivPos.parentNode)),this.InitHTMLLigne(),r=this.oGetElementByName(document,"_DEB"),e=0,r&&(o=this.nGetDebut(r.value),isNaN(o)||(e=o-1,s=this.sGetDebutCle(r.value),s&&(c=s))),clWDAJAXMain.m_bPageAWP&&this.m_oChampFormulaire&&(l=this.m_oChampFormulaire.value,i=document.createElement("input"),i.type="hidden",i.name=this.m_oChampFormulaire.name+"_SEL",i.id=i.name,this.m_oChampFormulaireSelAWP=this.m_oChampFormulaire.parentNode.appendChild(i)),this.Reinit(n,e,l,c,t)},WDTable.prototype.__CreeStyleLigneSelectionne=function(){if(0<this.m_tabStyle[2].length){for(var i=clWDUtil.sGetCSSTexte("."+this.m_tabStyle[2]),r="background-",u="color",t=i.split(";"),f=t.length,n=0;n<f;n++)r==clWDUtil.sSupprimeEspaces(t[n]).substr(0,r.length).toLowerCase()&&(u==clWDUtil.sSupprimeEspaces(t[n].split(":")[0]).substr(r.length,u.length).toLowerCase()&&(this.m_sCSSTexteStyleSelectionCouleurFond=clWDUtil.sSupprimeEspaces(t[n].split(":")[1])),t.splice(n,1),n--,f--);i=t.join(";"),0<i.length&&(this.m_sCSSTexteStyleSelection=i,this.m_tabCSSTexteCelluleSelection=[])}},WDTable.prototype.nGetDebut=function(n){return parseInt(n,10)},WDTable.prototype.sGetDebutCle=function(n){return(n=n+"",n.indexOf(";")>-1)?n.substring(n.indexOf(";")+1):null},WDTable.prototype.InitHTMLLigne=function(){this.m_sHTMLLigne=clWDUtil.sGetHTMLDansCommentaire(this.oGetIDElement(this.ID_TABLEINTERNE))},WDTable.prototype.Reinit=function(n,t,i,r,u){if(!(++this.m_nNbInits>16)){if(n===undefined||(this.m_nColonneTrie=n,this.m_nColonneTriePre=n),this.SetDebut(0),this.m_nNbLignes=0,this.m_oRedimColonnes=new WDRedimColonnes(this),this.m_oGestionSaisie=new WDSaisieCellule(this),this.m_oGestionRecherche=new WDPopupSaisieRecherche(this),this.m_oGestionRecherche.Init(),this.m_tabSelection=[],this.m_tabColonnes=[],this.m_nNbLignesPage=this.m_bSansLimite?0:-1,this.m_oCache=new WDTableCache(this,this.vCacheLigne),i){for(var f=parseInt(i,10);!isNaN(f);){if(this.m_tabSelection.push(f),i.indexOf(this.SEL_SEPARATEUR)==-1)break;i=i.substring(i.indexOf(this.SEL_SEPARATEUR)+1),f=parseInt(i,10)}this._vSetValeurChampFormulaire(isNaN(f)?"":f)}this.bOnResizeTable(!0,!1,t,r,u)||this.AfficheMasque(!0,!1)}},bTouch){function WDDragTable(n,t){arguments.length&&(WDDrag.prototype.constructor.apply(this,[0,100]),this.m_oChampTable=n,this.m_oCible=t,this._AttacheDetacheMouseDown(!0,t,this.m_fMouseDown))}WDDragTable.prototype=new WDDrag,WDDragTable.prototype.constructor=WDDragTable,WDDragTable.prototype._vbOnMouseDown=function(){return this.m_nPositionHorizontale=this.m_oCible.scrollLeft,WDDrag.prototype._vbOnMouseDown.apply(this,arguments)},WDDragTable.prototype._vOnMouseMove=function(n){WDDrag.prototype._vOnMouseMove.apply(this,arguments),this.m_oChampTable.__bForceDefilement(-this.nGetOffsetPosY(n),n),this.m_nPosY=this._nGetPosYEvent(n),this.m_oChampTable.m_bDebordeLargeur&&(this.m_oCible.scrollLeft=Math.max(0,this.m_nPositionHorizontale-this.nGetOffsetPosX(n)))},WDTable.prototype.InitForceDefilement=function(n){new WDDragTable(this,n)}}else WDTable.prototype.OnForceDefilement=function(n){var t;return t=n.wheelDelta?-n.wheelDelta/180*this.m_nHauteurLigne:(n.detail?n.detail:0)*20,this.__bForceDefilement(t,n)},WDTable.prototype.InitForceDefilement=function(n){var t=this,i=function(n){return t.OnForceDefilement(n||event)};clWDUtil.AttacheDetacheEvent(!0,n,bFF?"DOMMouseScroll":"mousewheel",i,!1)};WDTable.prototype.__bForceDefilement=function(n,t){return 0!=this.m_nNbLignes&&0!=n&&(n=this.__nForceDefilement(n,t,!0),n!=0)?clWDUtil.bStopPropagationCond(t,n!=0):!0},WDTable.prototype._vForceDefilement=clWDUtil.m_pfVide,WDTable.prototype.bMAJNbLignesVisibles=function(n,t){if(this._vMAJDebordeLargeur(),this.m_bSansLimite)return!1;this.RedimAscenseur();var i=this.bCalculeLigneAffiche(t);return t?i:(i&&(this.GenereLignesHTML(),this.InitEtatLignes(this.m_nNbLignesHTML),this.AfficheColonnes(),this.m_oCache.RecalculeMarges(this)),this.MAJAscenseur(),n&&i&&this.MAJLignes(),i)},WDTable.prototype.bOnResizeTable=function(n,t,i,r,u){var e,f;return this.bMAJNbLignesVisibles(t,!1),this.m_bDebordeLargeur||this.m_oRedimColonnes.ColonnesRestaure(),i&&i>1&&(this.SetDebut(i,r),this.m_nNbLignes=i+this.m_nNbLignesPage,this.m_bSansLimite||this.MAJAscenseur(!0)),u&&(f=this._oParseToXML(u),f&&f.firstChild&&(f.firstChild.tagName==clWDAJAXMain.XML_LISTE?e=f.firstChild:f.firstChild.nextSibling&&f.firstChild.nextSibling.tagName==clWDAJAXMain.XML_LISTE&&(e=f.firstChild.nextSibling))),e?this.bActionListe(e):(this.m_oCache.RemplitCache(this,n,-1,this.m_bSensTri),!1)},WDTable.prototype._oParseToXML=function(n){var i,t;return window.DOMParser?(new DOMParser).parseFromString(n,"text/xml"):window.ActiveXObject?(i=new ActiveXObject("MSXML.DomDocument"),i.async=!1,i.loadXML(n),i):window.XMLHttpRequest?(t=new XMLHttpRequest,t.open("GET","data:application/xml;charset=utf-8,"+encodeURIComponent(n),!1),t.overrideMimeType("application/xml"),t.send(null),t):undefined},WDTable.prototype.OnDisplay=function(n,t){WDChamp.prototype.OnDisplay.apply(this,arguments),t&&this.m_oDivPos&&bEstFils(this.m_oDivPos,n,document)&&(this._vMAJDebordeLargeur(),this.m_bSansLimite||this.MAJAscenseurRuptures(!0))},WDTable.prototype.InitEtatLignes=function(n){this.m_oEtatLignes=new WDEtatLignes(this,n)},WDTable.prototype.__nNbLignesPage=function(n){var t=this.m_nHauteurTableInterne;return this.m_bDebordeLargeur&&(t-=18),Math.floor(t/n*this.vnGetNbLignesLogiquesParLignePhysique())},WDTable.prototype.bCalculeLigneAffiche=function(n){var i,t,u,r;return(this.m_nHauteurTableInterne===undefined&&(i=this.oGetIDElement(this.ID_TABLEINTERNE),t=parseInt(bIE?i.height:i.getAttribute("height"),10),(isNaN(t)||t==0)&&(t=parseInt(i.style.height,10),(isNaN(t)||t==0)&&(t=parseInt(clWDUtil.oGetCurrentStyle(i).height,10))),(isNaN(t)||t<this.m_nHauteurLigne)&&(t=this.m_nHauteurLigne),this.m_nHauteurTableInterne=t,u=i.attributes.getNamedItem("height"),u&&i.removeAttribute("height",0),""!=i.style.height&&(i.style.height="")),r=this.__nNbLignesPage(this.m_nHauteurLigne),r!=this.m_nNbLignesPage)?(n||(this.m_nNbLignesPage=r),!0):!1},WDTable.prototype.CodeSelection=function(n){this.DeclarePCode(this.ms_nEventNavSelectLigne,new Function("event","return "+n+";"))},WDTable.prototype._vRefresh=function(n,t,i,r,u){WDChamp.prototype._vRefresh.apply(this,arguments);var f=!1;switch(n){case 1:this.SetDebut(0),this.m_bSansLimite||(f=!0);case 2:t>-1&&(this.SetDebut(t,i),f=!0)}undefined!==u&&u!=this.m_nNbLignes&&(this.m_nNbLignes=u,f=!0),undefined!==r&&(this.oGetElementByName(document,"_DATA").value=r),f&&!this.m_bSansLimite&&this.MAJAscenseur(!0),this.m_oCache.RemplitCache(this,!0,this.m_nColonneTrie,this.m_bSensTri),this.m_oEtatLignes.Invalide(this,this.m_nDebut,0,!1,null),this.AfficheMasque(!0,!0)},WDTable.prototype.SetDebut=function(n,t){if(this.m_nDebut=n,!t&&this.m_oCache){var i=this.m_oCache.oGetLigne(n);i&&(t=i.sGetCleEnreg(),t.length==0&&(t=null))}t?this.m_sCleDebut=t:delete this.m_sCleDebut},WDTable.prototype.RequeteSelection=function(n){var t=this._vsGetValeurChampFormulaire();this._vSetValeurChampFormulaire(this.sConstruitRequeteSelection()),this.m_oCache.CreeRequeteSelection(this,n),this._vSetValeurChampFormulaire(t),this.AfficheMasque(!0,!0)},WDTable.prototype.vnGetNbLignesLogiquesParLignePhysique=function(){return 1},WDTable.prototype.oGetIDCelluleRel=function(n,t){return this.m_oEtatLignes.oGetCelluleHTML(this,n,t)},WDTable.prototype._vSetValeurChampFormulaire=function(){WDChamp.prototype._vSetValeurChampFormulaire.apply(this,arguments),this.m_oChampFormulaireSelAWP&&(this.m_oChampFormulaireSelAWP.value=this.sConstruitRequeteSelection())},WDTable.prototype.nLigneSelectionne=function(n){return this.nLigneSelectionnePosAbsolue(this.nPosVisible2PosAbsolue(n))},WDTable.prototype.nLigneSelectionnePosAbsolue=function(n){return clWDUtil.nDansTableau(this.m_tabSelection,n)},WDTable.prototype.bLigneEstSelectionnee=function(n){return clWDUtil.nElementInconnu!=this.nLigneSelectionne(n)},WDTable.prototype.vbLigneEstSelectionneeSansZR=WDTable.prototype.bLigneEstSelectionnee,WDTable.prototype.__bLigneSelectionne=function(n,t,i){return this._bLigneSelectionnePosAbsolue(this.nPosVisible2PosAbsolue(n),n,t,i)},WDTable.prototype.bLigneSelectionnePosAbsolue=function(n,t,i,r){return clWDUtil.nElementInconnu!=this.nLigneSelectionnePosAbsolue(n)?!1:this._bLigneSelectionnePosAbsolue(n,t,i,r)},WDTable.prototype._bLigneSelectionnePosAbsolue=function(n,t,i,r){if(this.m_tabSelection.push(n),this.m_nNbLignesPage==0&&t<this.m_nNbLignes||this.m_nNbLignesPage!=0&&t>=this.m_nDebut&&t<=this.m_nDebut+this.m_nNbLignesPage+1){var u=this.m_oCache.oGetLigne(t);u&&u.SetStyle(this.m_tabStyle[2],this,t,r,!0)}return this._vSetValeurChampFormulaire(n+1),i&&this.RecuperePCode(this.ms_nEventNavSelectLigne)(r),!0},WDTable.prototype.bLigneDeselectionne=function(n,t){var r=this.m_tabSelection,f,i,u;return n<0||n>=r.length?!1:(f=r[n],i=this.nPosAbsolue2PosVisible(f),r.splice(n,1),(this.m_nNbLignesPage==0&&i<this.m_nNbLignes||this.m_nNbLignesPage!=0&&i>=this.m_nDebut&&i<=this.m_nDebut+this.m_nNbLignesPage+1)&&(u=this.m_oCache.oGetLigne(i),u&&u.SetStyle(this.m_tabStyle[i%2==0?0:1],this,i,t,!1)),this._vSetValeurChampFormulaire(r.length>0?r[r.length-1]+1:""),!0)},WDTable.prototype.bLigneDeselectionneTous=function(n,t){for(var f=this.nPosVisible2PosAbsolue(n),r=!1,u=this.m_tabSelection,i=0;u.length>i;)f!=u[i]?r=this.bLigneDeselectionne(i,t):i++;return r},WDTable.prototype.sConstruitRequeteSelection=function(){return this.m_tabSelection.join(this.SEL_SEPARATEUR)},WDTable.prototype.bActionListeDepuisAJAX=function(n,t){this.bActionListe(n)&&t>-1&&(this.m_nNbLignesPage==0&&t<this.m_nNbLignes||this.m_nNbLignesPage!=0&&t>=this.m_nDebut&&t<=this.m_nDebut+this.m_nNbLignesPage+1)&&this.MAJLigne(t)},WDTable.prototype.bActionListe=function(n){var e=this.m_nNbLignes,r,f,i,t,u;this.m_nNbLignes=parseInt(clWDAJAXMain.sXMLGetAttribut(n,this.XML_NOMBRE),10),r=document.getElementsByName("_"+this.sGetNomElement("_OCC"))[0],r&&(r.value=this.m_nNbLignes),clWDAJAXMain.bXMLAttributExiste(n,this.XML_DESACTIVESERSEL)&&(this.m_bRetourServeurSelection=!1),this.m_bHauteurLigneVariable=clWDAJAXMain.bXMLGetAttributSafe_Vrai(n,this.XML_HAUTEURLIGNEVARIABLE),this._vActionListeSpecifique(n),f=this.m_nNbRuptures,this.m_nNbRuptures=clWDAJAXMain.nXMLGetAttributSafe(n,WDAJAXMain.prototype.XML_CHAMP_LIGNES_RUPTURES,0),this.m_bSansLimite&&(e==this.m_nNbLignes&&this.vbZR()?this.m_nNbLignes==0&&this.InitEtatLignes(0):(this.GenereLignesHTML(),this.InitEtatLignes(this.m_nNbLignesHTML),this.AfficheColonnes())),this.m_nNbRuptures!=f&&this.m_oEtatLignes.RecalculeObjetsRuptures(this),clWDAJAXMain.bXMLAttributExiste(n,this.XML_TRI)?(this.m_nColonneTriePre=clWDAJAXMain.nXMLGetAttribut(n,this.XML_TRI),this.m_bSensTriPre=clWDAJAXMain.bXMLGetAttributSafe(n,this.XML_SENS),this.AfficheTriColonne(this.m_nColonneTriePre,!this.m_bSensTriPre)):(delete this.m_nColonneTriePre,delete this.m_bSensTriPre),this.m_bFinTrouve=clWDAJAXMain.bXMLGetAttributSafe(n,this.XML_FIN),this.m_sCleParcourtAP=clWDAJAXMain.sXMLGetAttributSafe(n,this.XML_CLEENREGAP,"");switch(clWDAJAXMain.nXMLGetAttributSafe(n,WDAJAXMain.prototype.XML_CHAMP_REFRESH_RESETTABLE,0)){case 1:return clWDAJAXMain.bXMLAttributExiste(n,this.XML_DEBUT)?(i=clWDAJAXMain.sXMLGetAttribut(n,this.XML_DEBUT),this._vRefresh(1,this.nGetDebut(i),this.sGetDebutCle(i))):this._vRefresh(1,-1),!1;case 2:return this._vRefresh(2,-1),!1;default:clWDAJAXMain.bXMLAttributExiste(n,this.XML_DEBUT)&&(i=clWDAJAXMain.sXMLGetAttribut(n,this.XML_DEBUT),this.SetDebut(this.nGetDebut(i),this.sGetDebutCle(i)))}for(this.m_oCache.SupprimeLignesInutiles(this),t=n.firstChild;t!=null;){switch(t.nodeName){case this.XML_LIGNES:this.m_oCache.RemplitCacheLignes(this,t);break;case this.XML_SELECTIONS:this.RemplitSelection(t);break;case this.XML_COLONNES:this.RemplitColonnes(t);break;case this.XML_ERREUR:this.AfficheErreur(t)}t=t.nextSibling}return this.m_bSansLimite||(u=clWDAJAXMain.bXMLAttributExiste(n,this.XML_DEBUT),(u||!this.bGetHauteurLigneVariable())&&this.MAJAscenseur(u)),this.vAffichePictoTriColonnes(),this.MAJLignes(),!this.m_bSansLimite&&this.bGetHauteurLigneVariable()&&this.MAJAscenseurRuptures(),this.m_bFinTrouve==!1&&this.ChercheFin(),!0},WDTable.prototype._vActionListeSpecifique=function(){},WDTable.prototype.bGetHauteurLigneVariable=function(){return this.m_bHauteurLigneVariable||this.m_nNbRuptures>0},WDTable.prototype._vsGetCSSLigneHeight=function(){return"height"},WDTable.prototype.GenereLignesHTML=function(){var n=this.oGetIDElement(this.ID_TABLEINTERNE),t,o,f,u,i,r,e;for(SupprimeFils(n),this.m_nNbLignesHTML=this.m_bSansLimite&&0<this.nGetNbRuptures()?this.m_nNbLignes:Math.ceil(this.m_bSansLimite?this.m_nNbLignes/this.vnGetNbLignesLogiquesParLignePhysique():this.m_nNbLignesPage/this.vnGetNbLignesLogiquesParLignePhysique()+2),t=this.m_sHTMLLigne,o=new RegExp("\\[%"+this.m_sAliasChamp+"%\\]","g"),t=t.replace(o,"[%_INDICE_%]"),t=t.replace(/\[%_CSS_HEIGHT_%\]/g,this._vsGetCSSLigneHeight),f=this.m_nNbLignesHTML,u=new Array(f),i=0;i<f;i++)u[i]=t.replace(/\[%_INDICE_%\]/g,i);bIE?(r=n.outerHTML,r=clWDAJAXMain.sSansEspace(r,!0,!0,!0),n.outerHTML=r.substr(0,r.length-"<\/TABLE>".length)+u.join("")+"<\/TABLE>"):(e=document.createRange(),e.setStart(n,0),n.appendChild(e.createContextualFragment(u.join(""))),n.style.width=n.style.width)},WDTable.prototype.RemplitSelection=function(n){var t,i;for(this.bLigneDeselectionneTous(-1),t=n.firstChild;t!=null;)i=clWDAJAXMain.nXMLGetValeur(t),this.bLigneSelectionnePosAbsolue(i,this.nPosAbsolue2PosVisible(i),!1),t=t.nextSibling},WDTable.prototype.nGetNbRuptures=function(){return this.m_nNbRuptures},WDTable.prototype.RemplitColonnes=function(n){this.m_tabColonnes=new Array(n.childNodes.length);for(var i=this.m_tabColonnes,t=n.firstChild,r=0;t!=null;)i[r++]=new WDColonne(t),t=t.nextSibling;this.AfficheColonnes()},WDTable.prototype.AfficheColonnes=function(){for(var t=this.m_tabColonnes,i=t.length,r=!0,n=0;n<i;n++)this.AfficheColonne(n,t[n].m_bVisible),0<t[n].m_nLargeur&&(r&&this.m_oRedimColonnes.__ColonnesFige(),this.m_oRedimColonnes.__SetDimColonne(n,t[n].m_nLargeur))},WDTable.prototype.nGetNbNiveauAutourCellule=function(n){return clWDUtil.bBaliseEstTag(n.parentNode,"td")&&n.parentNode.style.cssText!=""?6:2},WDTable.prototype.AfficheColonne=function(n,t){var i,r,e;if(this.AfficheCellule(this.ID_TITRE,n,2,t),i=this.oGetIDElement(0,n),i){var u=this.nGetNbNiveauAutourCellule(i),f=this.__oGetParent(i,u),o=clWDUtil.oGetCurrentStyle(f);if(o.display!=clWDUtil.sGetDisplayPourAffiche(f,t))for(e=this.m_oEtatLignes.nGetNbEtatLignes(),r=0;r<e;r++)this.AfficheCellule(r,n,u,t)}},WDTable.prototype.AfficheCellule=function(n,t,i,r){var f=this.oGetIDElement(n,t),u;if(f=this.__oGetParent(f,i),f){for(clWDUtil.SetDisplay(f,r),u=f.nextSibling;u&&u.nodeName=="#text";)u=u.nextSibling;u&&u.id.length==0&&clWDUtil.SetDisplay(u,r)}},WDTable.prototype.__oGetParent=function(n,t){while(n&&t-->0)n=n.parentNode;return n},WDTable.prototype.AfficheErreur=function(n){alert(clWDAJAXMain.sXMLGetValeur(n))},WDTable.prototype.vVideCellule=function(n){var i=n.tabGetCelluleHTMLCache(),t,r;for(r in i)i.hasOwnProperty(r)&&(t=i[r],t&&(SupprimeFils(t),t=t.parentNode,!this.vbZR()&&this.bGetHauteurLigneVariable()&&(t=t.parentNode),this.vnGetNbLignesLogiquesParLignePhysique()>1&&(t=t.firstChild),t.style.backgroundColor=""))},WDTable.prototype.vRemplitCellule=function(n,t,i,r,u,f){var e,c=this,l,o,a,v,y,h,p,s;this.m_tabColonnes[r].m_sBulle?n.title=this.m_tabColonnes[r].m_sBulle:n.removeAttribute("TITLE",0),l=!1;switch(this.nColonneType(r)){case WDAJAXMain.prototype.XML_CHAMP_TYPE_INTERRUPTEUR:if(!1==this.m_tabColonnes[r].m_bVisible)break;e=document.createElement("input"),e.type="checkbox",l=t=="1",v=this.sGetSuffixeIDElement(i,this.m_sAliasChamp,r),e.name=v,e.id=v,this.bColonneSaisissable(r)?e.onclick=function(n){return c.ClickInterrupteur(n||event,e,i,r),clWDUtil.bStopPropagation(n)}:e.disabled=!0,n.style.textAlign="center",n.style.verticalAlign="middle";break;case WDAJAXMain.prototype.XML_CHAMP_TYPE_IMAGE:t.length>0&&(e=document.createElement("img"),e.src=t,bIE?e.onreadystatechange=function(n){WDTable.prototype.s_RedimImage(n||event)}:e.onload=function(n){WDTable.prototype.s_RedimImage(n||event)},this.nColonneLien(r)>0&&(this.nColonneEtatLien(r)==0||this.nColonneEtatLien(r)==5)&&(e.onclick=function(n){c.OnColonneLien(i,r,n||event)}),n.style.textAlign="center",n.style.verticalAlign="middle");break;case WDAJAXMain.prototype.XML_CHAMP_TYPE_COMBO:case WDAJAXMain.prototype.XML_CHAMP_TYPE_SAISIE:default:switch(this.nColonneLien(r)){default:case 0:if(this.m_bHauteurLigneVariable&&(-1!=t.indexOf("\r")||-1!=t.indexOf("\n")))for(e=document.createElement("span"),y=t.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split("\n"),a=y.length,o=0;o<a;o++)o>0&&e.appendChild(document.createElement("br")),e.appendChild(document.createTextNode(clWDEncode.sEncodeCharset(y[o],!1)));else e=document.createTextNode(clWDEncode.sEncodeCharset(t,!1));break;case 1:case 2:e=document.createElement("a");switch(this.nColonneEtatLien(r)){default:case 0:case 5:e.href="javascript:void(0);",e.onclick=function(n){c.OnColonneLien(i,r,n||event)};break;case 4:e.disabled=!0;case 1:e.readOnly=!0}e.innerHTML=clWDEncode.sEncodeInnerHTML(t,!0)}}for(h=n.getElementsByTagName("a"),a=h.length,o=0;o<h;o++)h[o].onclick=null;SupprimeFils(n),e&&(p=n.appendChild(e),l&&(e.checked=!0)),undefined!==this.m_sCSSTexteStyleSelection&&(s=this.m_tabCSSTexteCelluleSelection[n.id],f?(undefined===s&&(s=clWDUtil.sGetCSSTexteElement(n),this.m_tabCSSTexteCelluleSelection[n.id]=s),n.style.cssText=s+this.m_sCSSTexteStyleSelection):undefined!==s&&(n.style.cssText=s,delete this.m_tabCSSTexteCelluleSelection[n.id])),p&&this.nColonneType(r)==WDAJAXMain.prototype.XML_CHAMP_TYPE_IMAGE&&this.s_RedimImageI(p),this.bColonneSaisissable(r)==!1&&(n.style.cursor="default")},WDTable.prototype.VideRuptures=function(n){this.nGetNbRuptures()>0&&(this.VideUneRupture(n.m_oRupturesHaut),this.VideUneRupture(n.m_oRupturesBas))},WDTable.prototype.VideUneRupture=function(n){n&&(SupprimeFils(n),clWDUtil.SetDisplay(n.parentNode,!1))},WDTable.prototype.RemplitRuptures=function(n,t,i){this.nGetNbRuptures()>0&&(i=i?i:{},this.RemplitUnRupture(n.m_oRupturesHaut,i.m_sHaut,t==0),this.RemplitUnRupture(n.m_oRupturesBas,i.m_sBas,!0))},WDTable.prototype.RemplitUnRupture=function(n,t,i){n&&(i&&this.VideUneRupture(n),t&&t.length&&(n.innerHTML=clWDEncode.sEncodeInnerHTML(t,!1,!0),clWDUtil.SetDisplay(n.parentNode,!0)))},WDTable.prototype.s_RedimImage=function(n){WDTable.prototype.s_RedimImageI(clWDUtil.oGetOriginalTarget(n))},WDTable.prototype.s_RedimImageI=function(n){var f,s;if((!bIE||n.readyState=="complete")&&n.parentNode){var u=n.offsetWidth,i=n.offsetHeight,r=n.parentNode.parentNode.clientWidth,t=n.parentNode.parentNode.clientHeight,e=r,o=t;if(u<=r){if(i<=t)return;e=u*t/i}else i<=t?o=i*r/u:(f=u/i,s=r/t,s>f?e=t*f:o=r*f);n.style.width=e+"px",n.style.height=o+"px"}},WDTable.prototype.ClickInterrupteur=function(n,t,i,r){var u=this.nAbsolue2Relative(i),f=t.checked?"1":"0",e=t.checked?1:0;this.bCreeLigneVirtuelle(u)&&(this.ChangementValeur(u,r,f,e),this.ValideChangement(u),this.bMAJLigne(i),this.SupprimeLignesVirtuelles())},WDTable.prototype.ChercheFin=function(){this.m_oCache.m_tabRequetes.length>0||this.m_bFinTrouve||this.nSetTimeoutUnique("EnvoieChercheFin",1e3)},WDTable.prototype.EnvoieChercheFin=function(){this.m_oCache.m_tabRequetes.length>0||this.m_bFinTrouve||this.m_oCache.CreeRequete(this,new Segment(-1,-1),-1,!0,-1,"")},WDTable.prototype.bMAJLigne=function(n){return this.m_oCache.bMAJLigne(this,n,this.vbLigneEstSelectionneeSansZR(n))},WDTable.prototype.bMAJLigneRel=function(n){return this.bMAJLigne(this.nRelative2Absolue(n))},WDTable.prototype.nRelative2Absolue=function(n){return n+this.m_nDebut},WDTable.prototype.nAbsolue2Relative=function(n){return n-this.m_nDebut},WDTable.prototype.MAJLignes=function(n){for(var u=0,c=this.m_oEtatLignes.nGetNbEtatLignes(),o=this.vnGetNbLignesLogiquesParLignePhysique(),i=this.m_nDebut,e,l=0,s=0,p,a,r,t,w,v,y,h,f=0;f<c;f++)for(r=this.oGetEtatLigne(f),t=0;t<o;t++,i++)if(w=r.bJamaisAffiche(t),i>=this.m_nNbLignes)(w||r.bPlein(t))&&r.MasqueLigne(t,this,i,n,i%2==0?this.m_tabStyle[0]:this.m_tabStyle[1]),u++;else{if(e=this.m_oCache.oGetLigne(i),e&&(l=e.vnGetNbReplieesOuEnroulees(),0<l&&(s+=l),p=f,a=t,e.vnGetColonneHTML()!=t)){for(;t<o;t++)r.MasqueLigne(t,this,i,n),u++;break}v=this.vbLigneEstSelectionneeSansZR(i),r.bMAJ(t,e,this,i,n,v),y=i%2==0?this.m_tabStyle[0]:this.m_tabStyle[1],(undefined!==this.m_sCSSTexteStyleSelection||undefined!=this.m_sCSSTexteStyleSelectionCouleurFond)&&v&&(y=this.m_tabStyle[2]),r.SetStyle(this,t,y),r.bPlein(t)&&u++}if(s>0&&u+s>=this.m_nNbLignes)for(f=p;f<c;f++){for(++i,t=a+1;t<o;t++)r.MasqueLigne(t,this,i,n),u++;a=-1}this.__PostMAJLignes(),h=c*o,0<s&&u!=h&&(u=h),this.AfficheMasque(u!=h,!1)},WDTable.prototype.__PostMAJLignes=function(){var t,i,n;if(window.FinSubmitAJAX&&typeof FinSubmitAJAX=="function"&&FinSubmitAJAX(),bIEQuirks9Max){t=clWDUtil.m_oDialogues;for(i in t)if(t.hasOwnProperty(i)&&(n=t[i],bEstFils(this.m_oDivPos,n.m_oCellule,document))){clWDUtil.bAvecClasse(n.m_oCellule,"WDForceReflow")?clWDUtil.RemplaceClassName(n.m_oCellule,"WDForceReflow",undefined):clWDUtil.RemplaceClassName(n.m_oCellule,undefined,"WDForceReflow");break}}this.m_bSansLimite&&clWDUtil.ForceRecalculAncrages()},WDTable.prototype.AfficheMasque=function(n,t){(this.m_oCache.bAvecRequeteTri()&&(n=!0),this.m_bMasqueVisible!=n)&&(this.m_bMasqueVisible=n,this.AfficheMasques(t),t&&this.nSetTimeout(this.AfficheMasques,1e3,!1))},WDTable.prototype.AfficheMasques=function(n){this.AfficheUnMasque(this.m_oMasque,this.m_bMasqueVisible&&!n),this.AfficheUnMasque(this.m_oMasqueTransparent,this.m_bMasqueVisible&&n)},WDTable.prototype.AfficheUnMasque=function(n,t){n.style.left=t?n.parentNode.scrollLeft:0,this.__RedimensionneUnMasque(n),clWDUtil.SetDisplay(n,t),n.style.visibility=""},WDTable.prototype.__RedimensionneMasques=function(){this.__RedimensionneUnMasque(this.m_oMasque),this.__RedimensionneUnMasque(this.m_oMasqueTransparent)},WDTable.prototype.__RedimensionneUnMasque=function(n){var t=clWDUtil.oGetCurrentStyle(n);n.style.width=Math.max(n.parentNode.clientWidth-(bIEQuirks?0:this.s_nGetOffsetBorderPourWidth(t)),0)+"px",n.style.height=Math.max(n.parentNode.clientHeight-(bIEQuirks?0:this.s_nGetOffsetBorderPourHeight(t)),0)+"px"},WDTable.prototype._vMasqueLigneInterne=clWDUtil.m_pfVide,WDTable.prototype.nGetAscenseurParentScrollTop=function(){var n=this.m_nAscenseurParentScrollTop?this.m_nAscenseurParentScrollTop:this.m_oAscenseurParent.scrollTop;return this.m_nFacteurAscenseur==1?n:n*this.m_nFacteurAscenseur*(1+this.m_nNbLignesPage*(this.m_nFacteurAscenseur-1)/(this.m_nNbLignes-this.m_nNbLignesPage))},WDTable.prototype.SetAscenseurParentScrollTop=function(n,t){var r=n,i,u;this.m_nFacteurAscenseur>1&&(r=n/this.m_nFacteurAscenseur,r*=1-t*(this.m_nFacteurAscenseur-1)/(this.m_nNbLignes-t)),i=Math.max(Math.floor(r),0),u=this.m_nAscenseurParentScrollTop!==undefined?this.m_nAscenseurParentScrollTop:this.m_oAscenseurParent.scrollTop,u!=i&&(this.m_nAscenseurParentScrollTop=i,this.SetAscenseurParentScrollTopCallBack(i))},WDTable.prototype.SetAscenseurParentScrollTopCallBack=function(n){delete this.m_nAscenseurParentScrollTop,this.m_oAscenseurParent.scrollTop=n},WDTable.prototype._vMAJDebordeLargeur=function(){this.m_bDebordeLargeur=this.m_oDivPos.parentNode.scrollWidth>this.m_oDivPos.parentNode.clientWidth,bIE&&this.m_bSansLimite&&this.m_bDebordeLargeur&&this.m_oDivPos.parentNode.style.overflowX=="auto"&&(this.m_oDivPos.parentNode.style.overflowX="scroll"),(this.m_oDivPos.parentNode.style.overflowX=="scroll"||this.m_oDivPos.parentNode.style.overflow=="scroll")&&(this.m_bDebordeLargeur=!0)},WDTable.prototype.RedimAscenseur=function(){var n=this.m_oAscenseurParent.parentNode.clientHeight-this._nGetHauteurAscenseurHorizontal(this.m_oDivPos.parentNode),t;n=Math.max(1,Math.min(this.m_oAscenseurParent.parentNode.clientHeight,n)),t=n+"px",this.m_oAscenseurParent.style.height!=t&&(this.m_oAscenseurParent.style.height=t)},WDTable.prototype.__nGetHauteurLigne=function(n){return this.m_oCache.nGetHauteur(n)},WDTable.prototype.__nGetHauteurPremiereLigne=function(){var i=this.oGetEtatLigne(0),n,t;return i&&(n=i.oGetLigneLogique(0),n&&(t=n.m_oLigneCache,t))?t.nGetHauteur():-1},WDTable.prototype.nGetHauteurLigneRel=function(n){if(this.m_bSansLimite){var t=this.oGetEtatLigne(n);return t.m_oLignePhysique.offsetHeight+this._vnGetOffset(t.m_oLignePhysique)}return this.__nGetHauteurLigne(this.nRelative2Absolue(n))},WDTable.prototype.nGetDivPosTop=function(){var i=this.m_oDivPos.style.top,n,t;return i.length==0?0:(n=parseFloat(this.m_oDivPos.style.top),this.bGetHauteurLigneVariable()&&(t=this.__nGetHauteurPremiereLigne(),t!=-1&&t!=this.m_nHauteurLigne&&(n=n*this.m_nHauteurLigne/t)),parseInt(n,10))},WDTable.prototype.SetDivPosTop=function(n){var i=n,t;this.bGetHauteurLigneVariable()&&(t=this.__nGetHauteurPremiereLigne(),-1==t&&(this._CalculeHauteurLigne(),t=this.__nGetHauteurPremiereLigne()),t!=this.m_nHauteurLigne&&(i=i*t/this.m_nHauteurLigne)),this.m_oDivPos.style.top=i+"px"},WDTable.prototype._vnGetOffset=function(n){return bIEQuirks?0:this.s_nGetOffset(n.borderBottomWidth)},WDTable.prototype._CalculeHauteurLigne=function(n){for(var e=this.m_oEtatLignes.nGetNbEtatLignes(),t,u,f,i,r=0;r<e;r++)t=this.oGetEtatLigne(r),t.bPlein(0)&&(u=t.oGetLigneLogique(0).m_oLigneCache,f=u.nGetHauteur(),(-1==f||n&&0==f)&&(i=t.m_oLignePhysique.offsetHeight,i+=this._vnGetOffset(t.m_oLignePhysique),this.nGetNbRuptures()>0&&(t.m_oRupturesHaut&&(i+=t.m_oRupturesHaut.parentNode.offsetHeight),t.m_oRupturesBas&&(i+=t.m_oRupturesBas.parentNode.offsetHeight)),u.SetHauteur(i)))},WDTable.prototype.nGetLastHauteurLigneMoyenne=function(){return this.m_nLastHauteurLigneMoyenne?this.m_nLastHauteurLigneMoyenne:this.m_nHauteurLigne},WDTable.prototype.nGetLastNbLignesLogiquesParLignePhysiqueMoyen=function(){return this.m_nLastNbLignesLogiquesParLignePhysiqueMoyen?this.m_nLastNbLignesLogiquesParLignePhysiqueMoyen:this.vnGetNbLignesLogiquesParLignePhysique()},WDTable.prototype.nGetHauteurLigneMoyenne=function(){var r,t;if(this.bGetHauteurLigneVariable()){for(var u=0,i=0,f=this.m_oEtatLignes.nGetNbEtatLignes(),n=0;n<f;n++)r=this.oGetEtatLigne(n),r.oGetLigneLogique(0).m_oLigneCache&&(t=r.oGetLigneLogique(0).m_oLigneCache.nGetHauteur(),t&&t>0&&(u+=t,i++));if(i>0)return Math.ceil(u/i);if(this.m_nLastHauteurLigneMoyenne&&this.m_nLastHauteurLigneMoyenne>0)return this.m_nLastHauteurLigneMoyenne}return this.m_nHauteurLigne},WDTable.prototype.nGetNbLignesLogiquesParLignePhysiqueMoyen=function(){var t=this.vnGetNbLignesLogiquesParLignePhysique(),f,n,e;if(this.nGetNbRuptures()>0){for(var u=0,r=0,o=this.m_oEtatLignes.nGetNbEtatLignes(),i=0;i<o;i++)for(f=this.oGetEtatLigne(i),e=t,n=0;n<e;n++)f.bPlein(n)&&(n==0&&r++,u++);return r>0?Math.min(u/r,t):t}return t},WDTable.prototype.MAJAscenseurRuptures=function(n){this._CalculeHauteurLigne(n),this.MAJAscenseur()},WDTable.prototype.MAJAscenseur=function(n,t){var r,i,f,u,e,s,o,h,c;this._vMAJDebordeLargeur(),this.RedimAscenseur(),n&&this.SetDivPosTop(0),this.m_oDivPos.parentNode.scrollTop="0px",r=this.nGetHauteurLigneMoyenne(),f=this.nGetNbLignesLogiquesParLignePhysiqueMoyen(),i=f>1?Math.floor(r*Math.ceil(this.m_nNbLignes/f)):Math.floor(r*this.m_nNbLignes),i<=0&&(i=1),this.m_nFacteurAscenseur=Math.ceil(i/this.m_nLimiteHauteur),this.m_nFacteurAscenseur>1&&(i=Math.floor(i/this.m_nFacteurAscenseur)),e=r==this.m_nHauteurLigne?this.m_nNbLignesPage:this.__nNbLignesPage(r),this.m_nDebut>0&&this.m_nNbLignes-this.m_nDebut<e&&(u=this.m_nNbLignes-e,u<0&&(u=0,this.SetAscenseurParentScrollTop(0,e)),this.SetDebut(u)),s=parseInt(this.m_oAscenseur.style.height,10),(s!=i||n)&&(o=this.nGetDivPosTop(),h=Math.floor((this.m_oAscenseurParent.scrollTop*this.m_nFacteurAscenseur-o)/r)!=this.m_nDebut||n,this.m_oAscenseur.style.height=i+"px",h&&(c=this.m_nDebut/f*r+o,this.SetAscenseurParentScrollTop(c,e))),this.m_nLastHauteurLigneMoyenne=r,this.m_nLastNbLignesLogiquesParLignePhysiqueMoyen=f,this.m_oAscenseurParent.onscroll||(this.m_oAscenseurParent.onscroll=this.m_fScroll),t||undefined==u||this.DeplaceTable(undefined,u)},WDTable.prototype.nGetDebutLogique=function(n){var r=n*this.nGetLastNbLignesLogiquesParLignePhysiqueMoyen(),t,i,u;if(this.nGetNbRuptures()>0&&(t=this.m_nDebut,i=this.m_oCache.oGetLigne(t),i))for(u=n>i.vnGetLigneHTML()?1:-1;t>=0&&t<this.m_nNbLignes;){if(!i)break;if(i.vnGetLigneHTML()==n&&i.vnGetColonneHTML()==0){r=t;break}t+=u,i=this.m_oCache.oGetLigne(t)}return r},WDTable.prototype.DeplaceTable=function(n,t){var e,s,o,i,y,h,c;if(this.m_oGestionSaisie.m_bSaisie&&this.m_oGestionSaisie.SaisieFin(!0,!1,undefined,n),this.m_oDivPos.parentNode.scrollTop="0px",e=Math.floor(this.nGetAscenseurParentScrollTop()/this.nGetLastHauteurLigneMoyenne()),s=this.nGetDebutLogique(e),s!=this.m_nDebut||(this.SetDivPosTop(Math.floor(e*this.nGetLastHauteurLigneMoyenne()-this.nGetAscenseurParentScrollTop())),undefined!==t)){this.m_tabSelection.length>0&&this.m_tabSelection[0]!=-1&&this._vMasqueLigneInterne(this.nPosAbsolue2PosVisible(this.m_tabSelection[0]),!0,n),this.SetDebut(s);for(var l=!1,a=!1,p=this.m_oEtatLignes.nGetNbEtatLignes(),v=this.vnGetNbLignesLogiquesParLignePhysique(),r=this.m_nDebut,u,f=0;f<p;f++){for(o=this.oGetEtatLigne(f),i=0;i<v;i++,r++){if(r>=this.m_nNbLignes)break;if(u=this.m_oCache.oGetLigne(r),u&&u.vnGetColonneHTML()!=i){for(;i<v;i++)o.MasqueLigne(i,this,r,n);break}o.bMAJ(i,u,this,r,n,this.vbLigneEstSelectionneeSansZR(r)),y=o.bPlein(i),!y&&!u&&r<this.m_nNbLignes&&(a=!0)}if(r>=this.m_nNbLignes)break}this.m_oEtatLignes.Invalide(this,-1,f+1,!0,n),this.AfficheMasque(a,!1),this.m_oCache.SupprimeLignesInutiles(this),this.AnnuleTimeXXX("RemplitCacheDiff",!1),this.m_oCache.m_nDebutCache==-1?(this.m_bRequeteDiffereeForce=l,this.nSetTimeoutUnique("RemplitCacheDiff",300)):this.m_oCache.RemplitCache(this,l,-1,this.m_bSensTri),this.MAJLignes(n),this.bGetHauteurLigneVariable()&&(h=this.m_oAscenseurParent.scrollHeight,c=this.m_oAscenseurParent.clientHeight,c<h&&h<=this.m_oAscenseurParent.scrollTop+c&&this.MAJAscenseur(!1,!0)),this.SetDivPosTop(Math.floor(e*this.nGetLastHauteurLigneMoyenne()-this.nGetAscenseurParentScrollTop()))}},WDTable.prototype.RemplitCacheDiff=function(){this.m_oCache.RemplitCache(this,this.m_bRequeteDiffereeForce),delete this.m_bRequeteDiffereeForce},WDTable.prototype.OnRedimCol=function(n,t,i){this.m_oRedimColonnes.bOnMouseDown(n,t,i)},WDTable.prototype.OnColonneLien=function(n,t,i){this.OnSelectLigne(this.nAbsolue2Relative(n),t,i,!0)},WDTable.prototype.vAffichePictoTriColonnes=function(){for(var i=this.m_tabColonnes,r=i.length,t,n=0;n<r;n++)t=this.oGetIDElement(this.ID_TITRE,this.ID_TRI,n),t&&clWDUtil.SetDisplay(t,i[n].m_bTri),t=this.oGetIDElement(this.ID_TITRE,this.ID_RECHERCHE,n),t&&clWDUtil.SetDisplay(t,i[n].m_bRecherche)},WDTable.prototype.AfficheTriColonne=function(n,t){var u=this,i,f,r,e,o;this.m_nColonneTrie!=-1&&(i=this.oGetIDElement(this.ID_TITRE,this.ID_TRI,this.m_nColonneTrie),i&&(i.src=this.m_tabImgTri[0],f=this.m_nColonneTrie,i.onclick=function(n){u.OnTriColonne(f,!1,n||event)})),this.m_nColonneTrie=n,this.m_bSensTri=!t,r=this.oGetIDElement(this.ID_TITRE,this.ID_TRI,this.m_nColonneTrie),r&&(r.src=t?this.m_tabImgTri[2]:this.m_tabImgTri[1],e=function(t){u.OnTriColonne(n,!1,t||event)},o=function(t){u.OnTriColonne(n,!0,t||event)},r.onclick=t?e:o)},WDTable.prototype.__nForceDefilement=function(n,t,i){var f=parseInt(this.m_oAscenseur.style.height,10),r,u;return f<=this.m_oAscenseurParent.clientHeight?0:(r=this.m_oAscenseurParent.scrollTop,u=r+n<0?0:r+n>f-this.m_oAscenseurParent.clientHeight?f-this.m_oAscenseurParent.clientHeight:r+n,i&&u!=r&&this._vForceDefilement(t),this.m_oAscenseurParent.scrollTop=u,this.DeplaceTable(t),this.m_oAscenseurParent.scrollTop-r)},WDTable.prototype.OnSelectLigne=function(n,t,i,r){var u,o,s,e,h;if(this.m_nTypeSelection!=WDTable.prototype.SELECTION_SANS&&!(this.m_oCache.m_tabRequetes.length>0)){var c=i&&!r?i.ctrlKey:!1,l=i&&!r?i.shiftKey:!1,f=this.nRelative2Absolue(n);if(!(f>=this.m_nNbLignes)&&(!this.m_oGestionSaisie.m_bSaisie||n!=this.m_oGestionSaisie.m_nLigneRelative||t!=this.m_oGestionSaisie.m_nColonne)&&(u=!1,o=this.m_nTypeSelection==WDTable.prototype.SELECTION_SIMPLE||r,(o||c==!1&&l==!1)&&(u=this.bLigneDeselectionneTous(f,i)),u||!this.m_oGestionSaisie.m_bSaisie)){if(s=this.nLigneSelectionne(f,i),clWDUtil.nElementInconnu!=s)(o||this.m_nTypeSelection==WDTable.prototype.SELECTION_MULTIPLE)&&c&&(u=this.bLigneDeselectionne(s,i)),r&&(u=this.__bLigneSelectionne(f,!0,i));else{if(!o&&l==!0&&this.m_tabSelection.length>0)for(e=this.nPosAbsolue2PosVisible(this.m_tabSelection[0]),h=e<f?1:-1,e+=h;e!=f;e+=h)u|=this.__bLigneSelectionne(e,!0,i);u|=this.__bLigneSelectionne(f,!0,i)}this.m_oGestionSaisie.OnClickCellule(n,t,i),(u||r)&&this.m_bRetourServeurSelection&&this.RequeteSelection(r?t:-1)}}},WDTable.prototype.OnTriColonne=function(n,t,i){this.AfficheTriColonne(n,t),this.m_oCache.RemplitCache(this,!1,n,this.m_bSensTri),this.m_oEtatLignes.Invalide(this,this.m_nDebut,0,!1,i),this.AfficheMasque(!0,!1)},WDTable.prototype.OnRechercheSouris=function(n,t,i){return n==this.m_nColonneRecherche?!0:(t.src=this.m_tabImgRecherche[i?1:0],!0)},WDTable.prototype.OnRechercheColonne=function(n,t){this.m_oGestionRecherche.Debut(t.parentNode,0,t,n)},WDTable.prototype.OnRechercheValide=function(n,t,i){this.m_oCache.CreeRequeteRecherche(this,t,i),this.m_oEtatLignes.Invalide(this,this.m_nDebut,0,!1,n),this.AfficheMasque(!0,!0)},WDTable.prototype.nNbColonnes=function(){return this.m_tabColonnes.length},WDTable.prototype.bColonneSaisissable=function(n){return n>=this.m_tabColonnes.length||n<0?!1:this.m_tabColonnes[n].m_nLien!=0?!1:this.m_tabColonnes[n].m_bSaisissable},WDTable.prototype.nColonneLien=function(n){return n>=this.m_tabColonnes.length||n<0?WDColonne.prototype.m_nLien:this.m_tabColonnes[n].m_nLien},WDTable.prototype.nColonneEtatLien=function(n){return n>=this.m_tabColonnes.length||n<0?WDColonne.prototype.m_nEtatLien:this.m_tabColonnes[n].m_nEtatLien},WDTable.prototype.nColonneType=function(n){return this.m_tabColonnes[n].m_nType},WDTable.prototype.tabColonneCombo=function(n){return n>=this.m_tabColonnes.length||n<0?WDColonne.prototype.m_tabOptions:this.m_tabColonnes[n].m_tabOptions},WDTable.prototype.tabContenuCellule=function(n,t){var i=this.m_oCache.tabContenuCellule(this.nRelative2Absolue(n),t);return i?i:this.tabColonneCombo(t)},WDTable.prototype.ChangementValeur=function(n,t,i,r){this.bColonneSaisissable(t)&&this.m_oCache.ChangementValeur(this.nRelative2Absolue(n),n,t,i,r)},WDTable.prototype.vPreMAJLigne=clWDUtil.m_pfVide,WDTable.prototype.vPostMAJLigne=clWDUtil.m_pfVide,WDTable.prototype.nGetLigneHTMLDebut=function(){return this.m_oCache.oGetLigne(this.m_nDebut).vnGetLigneHTML(this.m_nDebut)},WDTable.prototype.oGetEtatLigne=function(n){return this.m_oEtatLignes.oGetEtatLigne(n)},WDTable.prototype.NoteMAJLigne=function(n){if(this.m_nNbLignesPage==0&&n<this.m_nNbLignes||this.m_nNbLignesPage!=0&&n>=this.m_nDebut&&n<=this.m_nDebut+this.m_nNbLignesPage+1){var t=this.m_oCache.oGetLigne(n);t&&this.oGetEtatLigne(t.vnGetLigneHTML(n)-this.nGetLigneHTMLDebut()).Detache(t.vnGetColonneHTML())}},WDTable.prototype.MAJLigne=function(n,t){var i=this.m_oCache.oGetLigne(n);i&&(this.oGetEtatLigne(i.vnGetLigneHTML(n)-this.nGetLigneHTMLDebut()).bMAJ(i.vnGetColonneHTML(),i,this,n,t,this.vbLigneEstSelectionneeSansZR(n)),this.__PostMAJLignes())},WDTable.prototype.nPosAbsolue2PosVisible=function(n){return n!=-1?this.m_oCache.nPosAbsolue2PosVisible(n):-1},WDTable.prototype.nPosVisible2PosAbsolue=function(n){return n!=-1?this.m_oCache.nPosVisible2PosAbsolue(n):-1},WDTable.prototype.ValideChangement=function(n){this.m_oCache.ValideChangement(this,this.nRelative2Absolue(n))},WDTable.prototype.SupprimeLignesVirtuelles=function(){this.m_oCache.SupprimeLignesVirtuelles()},WDTable.prototype.bCreeLigneVirtuelle=function(n){return this.m_oCache.bCreeLigneVirtuelle(this.nRelative2Absolue(n))},WDTable.prototype.sGetCellule=function(n,t,i){return this.m_oCache.sGetCellule(this.nRelative2Absolue(n),t,i)},WDSaisieCellule.prototype.m_nLigneRelative=-1,WDSaisieCellule.prototype.m_nColonne=-1,WDSaisieCellule.prototype.m_nDiffClick=1e3,WDSaisieCellule.prototype.OnClickCellule=function(n,t,i){var r,u;switch(this.m_oChampTable.nColonneType(t)){case WDAJAXMain.prototype.XML_CHAMP_TYPE_INTERRUPTEUR:case WDAJAXMain.prototype.XML_CHAMP_TYPE_IMAGE:this.m_bSaisie&&this.SaisieFin(!0,!1,undefined,i);return}if(this.m_nLigneRelative==n)if(this.m_nColonne==t){if(this.m_bSaisie)return;if(+new Date-this.m_oDateClick.getTime()<this.m_nDiffClick){this.SaisieCommence(i);return}}else if(this.m_bSaisie){this.SaisieFin(!0,!0,t,i);return}this.m_bSaisie&&this.SaisieFin(!0,!1,undefined,i),this.m_nLigneRelative!=-1&&this.m_nColonne!=-1&&(r=this.m_oChampTable.oGetIDCelluleRel(this.m_nLigneRelative,this.m_nColonne),r&&(r.ondblclick=null)),this.m_nLigneRelative=n,this.m_nColonne=t,this.m_oDateClick=new Date,u=this,this.m_oChampTable.oGetIDCelluleRel(this.m_nLigneRelative,this.m_nColonne).ondblclick=function(n){u.m_bSaisie||u.SaisieCommence(n||event)}},WDSaisieCellule.prototype.SaisieCommence=function(n){var f=this.m_oChampTable.oGetIDCelluleRel(this.m_nLigneRelative,this.m_nColonne),u,e,t,c,l,s,r,a,o,i,h;if(f.ondblclick=null,!this.m_oChampTable.bColonneSaisissable(this.m_nColonne)||!this.m_oChampTable.bCreeLigneVirtuelle(this.m_nLigneRelative)){this.m_nLigneRelative=-1,this.m_nColonne=-1,delete this.m_oDateClick,delete this.m_bSaisie;return}u=document.createElement("form"),u.method="POST",u.action="javascript:return false;",u.onsubmit=this.m_pfOnSubmit,e=-1,this.m_oChampTable.bGetHauteurLigneVariable()&&(e=this.m_oChampTable.nGetHauteurLigneRel(this.m_nLigneRelative)),e=Math.max(e,this.m_oChampTable.m_nHauteurLigne),u.style.width="100%",u.style.height=e-4+"px",c=this.m_oChampTable.nColonneType(this.m_nColonne);switch(c){case WDAJAXMain.prototype.XML_CHAMP_TYPE_COMBO:for(l=this.m_oChampTable.sGetCellule(this.m_nLigneRelative,this.m_nColonne,!0),t=document.createElement("select"),s=this.m_oChampTable.tabContenuCellule(this.m_nLigneRelative,this.m_nColonne),a=s.length,r=0;r<a;r++)t.options[r]=new Option(s[r],r),l==r&&(t.options[r].selected=!0),t.options[r].innerHTML=clWDEncode.sEncodeInnerHTML(t.options[r].innerHTML,!1,!0);t.id=f.id+"_SAI";break;case WDAJAXMain.prototype.XML_CHAMP_TYPE_INTERRUPTEUR:break;case WDAJAXMain.prototype.XML_CHAMP_TYPE_IMAGE:break;case WDAJAXMain.prototype.XML_CHAMP_TYPE_SAISIE:default:o=this.m_oChampTable.sGetCellule(this.m_nLigneRelative,this.m_nColonne),-1!=o.indexOf("\r")||-1!=o.indexOf("\n")?t=document.createElement("textarea"):(t=document.createElement("input"),t.type="TEXT"),t.value=clWDEncode.sEncodeCharset(o,!1),t.id=f.id+"_SAI"}for(t.onblur=this.m_pfOnBlur,t.onkeydown=this.m_pfOnKeyDown,t.onchange=this.m_pfOnChange,t.style.width="100%",t.style.height=e-4+"px",t.style.borderWidth="0",t.style.borderStyle="solid",i=f;clWDUtil.bBaliseEstTag(i,"div")&&i.style.backgroundColor=="";)i=i.parentNode;t.style.borderColor=clWDUtil.oGetCurrentStyle(i).backgroundColor,t.style.fontSize=i.offsetHeight<=18&&i.offsetHeight>0?Math.max(i.offsetHeight-4,6)+"px":clWDUtil.oGetCurrentStyle(i).fontSize,t.style.fontFamily=clWDUtil.oGetCurrentStyle(i).fontFamily,t.style.fontWeight=clWDUtil.oGetCurrentStyle(i).fontWeight,t.style.fontStyle=clWDUtil.oGetCurrentStyle(i).fontStyle,SupprimeFils(f),u.appendChild(t),this.m_fOldClick=i.onclick,i.onclick=null,this.m_oParentTable=i,this.m_oFormSaisie=f.appendChild(u),h=this.m_oFormSaisie.elements[0],clWDUtil.DonneFocus(h),this.m_bSaisie=!0,this.__bOnXxxPourCodeNav(n,h,"onfocus")},WDSaisieCellule.prototype.SaisieFin=function(n,t,i,r){var h,s,u,c;if(this.m_oChampTable.oGetIDCelluleRel(this.m_nLigneRelative,this.m_nColonne).ondblclick=null,this.m_oFormSaisie){if(this.m_oFormSaisie.elements[0].onblur=null,this.m_oFormSaisie.elements[0].onkeypress=null,n){var f="",e=-1,o=this.m_oChampTable.nColonneType(this.m_nColonne);switch(o){case WDAJAXMain.prototype.XML_CHAMP_TYPE_COMBO:h=this.m_oFormSaisie.elements[0].value,e=parseInt(h,10),f=this.m_oChampTable.tabContenuCellule(this.m_nLigneRelative,this.m_nColonne)[e];break;case WDAJAXMain.prototype.XML_CHAMP_TYPE_INTERRUPTEUR:break;case WDAJAXMain.prototype.XML_CHAMP_TYPE_IMAGE:break;case WDAJAXMain.prototype.XML_CHAMP_TYPE_SAISIE:default:f=this.m_oFormSaisie.elements[0].value}if(this.m_oChampTable.ChangementValeur(this.m_nLigneRelative,this.m_nColonne,f,e),t&&(i==-1||i==-2))for(s=i==-2?-1:1,c=this.m_oChampTable.nNbColonnes(),u=this.m_nColonne+s;i==-1&&u<c||i==-2&&0<=u;u+=s)if(o=this.m_oChampTable.nColonneType(u),o!=WDAJAXMain.prototype.XML_CHAMP_TYPE_INTERRUPTEUR&&this.m_oChampTable.bColonneSaisissable(u)){i=u;break}t&&this.m_oChampTable.bColonneSaisissable(i)||this.m_oChampTable.ValideChangement(this.m_nLigneRelative)}if(this.m_oFormSaisie=clWDUtil.oSupprimeElement(this.m_oFormSaisie),this.m_oParentTable.onclick=this.m_fOldClick,delete this.m_fOldClick,delete this.m_oParentTable,this.m_oChampTable.bMAJLigneRel(this.m_nLigneRelative),delete this.m_oFormSaisie,t&&i!=-1&&this.m_oChampTable.bColonneSaisissable(i)){this.m_nColonne=i,this.SaisieCommence(r);return}this.m_nLigneRelative=-1,this.m_nColonne=-1,delete this.m_oDateClick,delete this.m_bSaisie}this.m_oChampTable.SupprimeLignesVirtuelles()},WDSaisieCellule.prototype.__bOnSubmit=function(n){return this.SaisieFin(!0,!0,-1,n),clWDUtil.bStopPropagation(n)},WDSaisieCellule.prototype.__bOnBlur=function(n){var t=bIE?n.srcElement:n.target;return this.__bOnXxxPourCodeNav(n,t,"onblur"),this.SaisieFin(!0,!1,undefined,n),clWDUtil.bStopPropagation(n)},WDSaisieCellule.prototype.__bOnKeyDown=function(n){var t=bIE?n.srcElement:n.target;switch(n.keyCode){case 9:this.SaisieFin(!0,!0,n.shiftKey?-2:-1,n);break;case 27:this.SaisieFin(!1,undefined,undefined,n);break;case 37:if(this.__bOnFlecheGaucheDroite(t,!1))this.SaisieFin(!0,!0,-2,n);else return!0;break;case 39:if(this.__bOnFlecheGaucheDroite(t,!0))this.SaisieFin(!0,!0,-1,n);else return!0;break;default:return!0}return clWDUtil.bStopPropagation(n)},WDSaisieCellule.prototype.__bOnChange=function(n){var i=bIE?n.srcElement:n.target,r=!1===this.__bOnXxxPourCodeNav(n,i,"onchange"),t;if(clWDUtil.bBaliseEstTag(i,"select")){if(t=n.keyCode,undefined!==t)switch(t){case 9:this.SaisieFin(!0,!0,n.shiftKey?-2:-1,n);break;default:return r}return clWDUtil.bStopPropagation(n)}return r},WDSaisieCellule.prototype.__bOnFlecheGaucheDroite=function(n,t){switch(clWDUtil.sGetTagName(n)){case"input":switch(n.type.toLowerCase()){case"checkbox":return!0;case"text":var i=this.__nGetCurseur(n,t);return!t&&i==0||t&&i==n.value.length}break;case"select":return!0}return!1},WDSaisieCellule.prototype.__nGetCurseur=function(n,t,i){var f=i?t.selectionEnd:t.selectionStart,u,r;return typeof f=="number"?f:(u=document.selection.createRange(),r=t.value.length,i?r-u.moveEnd("character",r):-u.moveStart("character",-r))},WDSaisieCellule.prototype.__bOnXxxPourCodeNav=function(n,t,i){var r=t.parentNode.parentNode[i];return r?r(n):!0},WDRedimColonnes.prototype=new WDDrag,WDRedimColonnes.prototype.constructor=WDRedimColonnes,WDRedimColonnes.prototype.__tabSauveLargeurColonnes=function(n){for(var f=[],i=0,t=this.m_oChampTable.oGetIDCelluleRel(0,i),o=this.m_oChampTable.nNbColonnes(),r,e,u;t||i<o;){if(t){while(!clWDUtil.bBaliseEstTag(t,"td"))t=t.parentNode;r=clWDUtil.oGetCurrentStyle(t),e=r.visibility,(e=="visible"||e=="inherit")&&r.display!="none"&&((t.width+"").indexOf("%")==-1&&n||(u=t.offsetWidth,bIEQuirks||(u-=WDChamp.prototype.s_nGetOffsetBorderPourWidth(r)),n?(f[i]=t.width,this.__SetDimColonne(i,u)):f[i]=u))}i++,t=this.m_oChampTable.oGetIDCelluleRel(0,i)}return f},WDRedimColonnes.prototype.__RestaureLargeurColonnes=function(n){for(var i=n.length,t=0;t<i;t++)n[t]!==undefined&&this.__SetDimColonne(t,n[t])},WDRedimColonnes.prototype.__ColonnesFige=function(){var n=this.m_oChampTable.oGetIDElement(this.m_oChampTable.ID_TABLEINTERNE),t=this.m_oChampTable.oGetIDElement(this.m_oChampTable.ID_TITRE,this.m_oChampTable.ID_POSITION_PIXEL);this.m_bRedimEffectue=!0,this.m_sTableTaille=n.width,this.m_sTableTitreTaille=t.width,this.m_tabColonnesTaille=this.__tabSauveLargeurColonnes(!0),n.width="",t.width=""},WDRedimColonnes.prototype.ColonnesRestaure=function(){if(this.m_bRedimEffectue){this.__RestaureLargeurColonnes(this.m_tabColonnesTaille);var n=this.m_oChampTable.oGetIDElement(this.m_oChampTable.ID_TITRE,this.m_oChampTable.ID_POSITION_PIXEL);this.m_oChampTable.oGetIDElement(this.m_oChampTable.ID_TABLEINTERNE).width=this.m_sTableTaille,n.width=this.m_sTableTitreTaille,delete this.m_bRedimEffectue,delete this.m_tabColonnesTaille,delete this.m_sTableTaille,delete this.m_sTableTitreTaille}},WDRedimColonnes.prototype._vbOnMouseDown=function(n,t,i){return WDDrag.prototype._vbOnMouseDown.apply(this,[n])?(this.m_bRedimEffectue||this.__ColonnesFige(),this.m_nColonne=t,this.m_nTailleOriginale=this.m_oChampTable.oGetIDCelluleRel(0,t).parentNode.offsetWidth,this.m_nTailleMinimale=i,!0):!1},WDRedimColonnes.prototype._vOnMouseMove=function(n){var t,i;WDDrag.prototype._vOnMouseMove.apply(this,arguments),t=this.nGetOffsetPosX(n)+this.m_nTailleOriginale,t<8&&(t=8),this.m_nTailleMinimale!=-1&&t<this.m_nTailleMinimale&&(t=this.m_nTailleMinimale),this.__SetDimColonne(this.m_nColonne,t),this.m_oChampTable.bMAJNbLignesVisibles(!0,!0)&&(i=this.__tabSauveLargeurColonnes(!1),this.m_oChampTable.bMAJNbLignesVisibles(!0,!1)&&this.__RestaureLargeurColonnes(i))},WDRedimColonnes.prototype.__SetDimColonne=function(n,t){var r=(t+"").indexOf("%")!=-1?"":"px",e=2+(bHTML5?1:0),i,u,f;for(this.__nSetDimCellule(this.m_oChampTable.ID_TITRE,n,t,e,!0,r),u=this.m_oChampTable.m_oEtatLignes.nGetNbEtatLignes(),i=0;i<u;i++)f=this.__nSetDimCellule(i,n,t,f,!1,r)},WDRedimColonnes.prototype.__nSetDimCellule=function(n,t,i,r,u,f){var e=this.m_oChampTable.oGetIDElement(n,t),o;if(e){for(undefined==r&&(r=this.m_oChampTable.nGetNbNiveauAutourCellule(e)+(bHTML5?1:0)),u&&(e=e.firstChild,r++),o=r;--o>0;)e=e.parentNode,e.style.width=i+f;e=e.parentNode,e.style.width=i}return r},WDRedimColonnes.prototype._vOnMouseUp=function(){delete this.m_nTailleOriginale,delete this.m_nTailleMinimale,delete this.m_nColonne,WDDrag.prototype._vOnMouseUp.apply(this,arguments)},WDPopupSaisieRecherche.prototype=new WDPopupSaisie,WDPopupSaisieRecherche.prototype.constructor=WDPopupSaisieRecherche,WDPopupSaisieRecherche.prototype.Init=function(){WDPopupSaisie.prototype.Init.apply(this,arguments)},WDPopupSaisieRecherche.prototype._vDebut=function(n,t,i,r){WDPopupSaisie.prototype._vDebut.apply(this,[i.parentNode,i.offsetWidth]),i.src=this.m_oObjetParent.m_tabImgRecherche[2],this.m_nColonneRecherche=r,this.m_oImgOrigine=i,this.m_fOnMouseDown=i.onmousedown,i.onmousedown=this.m_fValide},WDPopupSaisieRecherche.prototype._vValide=function(n,t){WDPopupSaisie.prototype._vValide.apply(this,arguments),t.length>0&&this.m_oObjetParent.OnRechercheValide(n,this.m_nColonneRecherche,t)},WDPopupSaisieRecherche.prototype._vAnnule=function(){WDPopupSaisie.prototype._vAnnule.apply(this,arguments),this.m_oImgOrigine&&(this.m_oImgOrigine.src=this.m_oObjetParent.m_tabImgRecherche[0],this.m_oImgOrigine.onmousedown=null,this.m_fOnMouseDown!==undefined&&(this.m_oImgOrigine.onmousedown=this.m_fOnMouseDown)),delete this.m_nColonneRecherche,delete this.m_oImgOrigine,delete this.m_fOnMouseDown}