/*! VersionVI: 30F180062h x */
function WDZRCacheLigne(n,t,i){n&&(WDTableCacheLigne.prototype.constructor.apply(this,arguments),this.m_nLignePosVisibleEff=clWDAJAXMain.nXMLGetAttributSafe(n,this.XML_LIGNE_EFFECTIVE,parseInt(i/t.vnGetNbLignesLogiquesParLignePhysique(),10)),this.m_nColonneEff=clWDAJAXMain.nXMLGetAttributSafe(n,this.XML_COLONNE_EFFECTIVE,i%t.vnGetNbLignesLogiquesParLignePhysique()),this.m_nNbRepliee=clWDAJAXMain.nXMLGetAttributSafe(n,WDAJAXMain.prototype.XML_CHAMP_LIGNES_NBREPLIEES,0))}function WDZR(n,t,i,r,u,f,e){n&&(WDTable.prototype.constructor.apply(this,[n,t,i,r,u,WDTable.prototype.SELECTION_SIMPLE,f]),this.m_nNbLignesLogiquesParLignePhysique=e,this.m_tabChampsFils=new WDTableauChamps,this.ms_tabTablesZRs.DeclareChamp(this))}function WDZRValideLigne(n,t,i){this.m_nLigneAbsolue=t,this.m_sCelluleId=n,this.m_bChangement=i,this.m_sContenu=clWDAJAXMain.sConstruitValeurPage(clWDUtil.tabGetElements(document.getElementById(n),!1))}WDZRCacheLigne.prototype=new WDTableCacheLigne,WDZRCacheLigne.prototype.constructor=WDZRCacheLigne,WDZRCacheLigne.prototype.XML_LIGNE_EFFECTIVE="LIGNEEFF",WDZRCacheLigne.prototype.XML_COLONNE_EFFECTIVE="COLONNEEFF",WDZRCacheLigne.prototype._vPlaceXMLDansCellule=function(n,t){var i=n.childNodes;i.length==3&&i[1].nodeName==WDAJAXMain.prototype.XML_CHAMP_LIGNES_LIGNE_CORPS&&(t.m_sValeur=clWDAJAXMain.sXMLGetValeur(i[1]))},WDZRCacheLigne.prototype.vnGetLigneHTML=function(){return this.m_nLignePosVisibleEff},WDZRCacheLigne.prototype.vnGetColonneHTML=function(){return this.m_nColonneEff},WDZRCacheLigne.prototype.vnGetNbReplieesOuEnroulees=function(){return this.m_nNbRepliee-1},WDZRCacheLigne.prototype.nGetNbReplieesInclusSelf=function(){return this.m_nNbRepliee},WDZR.prototype=new WDTable,WDZR.prototype.constructor=WDZR,WDZR.prototype.vCacheLigne=WDZRCacheLigne,WDZR.prototype.vbZR=function(){return!0},WDZR.prototype.vZRDeclareChampFils=function(n){this.m_tabChampsFils.DeclareChamp(n)},WDZR.prototype.vZROnSelectLigne=function(n,t){this.OnSelectLigne(n-1-this.m_nDebut,0,t)},WDZR.prototype.vZROnValideLigne=function(){var n=this.m_oCache.oGetLigne(this.m_tabSelection[0]),t=this._sGetIDCellule(n);this.__OnValideLigneZR(new WDZRValideLigne(t,this.m_tabSelection[0],!0))},WDZR.prototype._vForceDefilement=function(){var n=this.oGetIDElement(this.ID_TABLEINTERNE),t;try{bIEQuirks||(t=n.tabIndex,n.tabIndex="1000"),n.focus()}finally{bIEQuirks||(n.tabIndex=t)}WDTable.prototype._vForceDefilement.apply(this,arguments)},WDZR.prototype._vRefresh=function(n){switch(n){case 1:case 2:this.AnnuleTimeXXX("_OnValideLigneZR"),undefined!==this.m_oValideLigneZR&&(this.m_oValideLigneZR=null,delete this.m_oValideLigneZR)}WDTable.prototype._vRefresh.apply(this,arguments)},WDZR.prototype._vnGetOffset=function(){return 0},WDZR.prototype._vsGetCSSLigneHeight=function(){return bIEQuirks?"height":"min-height"},WDZR.prototype.vbLigneEstSelectionneeSansZR=function(){return!1},WDZR.prototype.vVideCellule=function(n,t){this.__VideCellule(n.oGetCelluleHTML(this,t))},WDZR.prototype.__VideCellule=function(n){clWDUtil.SupprimeFilsEtOnFocus(n,!0)},WDZR.prototype.vRemplitCellule=function(n,t,i,r,u){var o,s,e,c;if(this.__VideCellule(n),o=n.parentNode,1==this.vnGetNbLignesLogiquesParLignePhysique()&&(o=o.parentNode),s=0==u.nGetNbReplieesInclusSelf(),clWDUtil.SetDisplay(o,s),s){n.innerHTML=clWDEncode.sEncodeInnerHTML(t,!1,!0);for(var h=n.id,l=clWDUtil.tabGetElements(n,!0),a=l.length,f=0;f<a;f++)e=l[f],c=e.onchange===undefined,clWDUtil.SetOnXxx(e,"onblur",this,this.OnValideLigneZR,[h,i,c]),!1==c&&clWDUtil.SetOnXxx(e,"onchange",this,this.OnValideLigneZR,[h,i,!0]),clWDUtil.SetOnXxx(e,"onfocus",this,this.OnFocusLigneZR,[h,i,f])}},WDZR.prototype._vMAJDebordeLargeur=function(){this.m_bDebordeLargeur=!1},WDZR.prototype.vAffichePictoTriColonnes=function(){},WDZR.prototype.vnGetNbLignesLogiquesParLignePhysique=function(){return this.m_nNbLignesLogiquesParLignePhysique},WDZR.prototype.OnValideLigneZR=function(n,t){var r=t[0],u=t[1],i=t[2];if(this.m_bChangementValideLigneZRSuivant&&(i=!0,delete this.m_bChangementValideLigneZRSuivant),this.bEstLienOuImageDansLien(n))if(this.m_bValideLigneZRCelluleDansLien)delete this.m_bValideLigneZRCelluleDansLien;else return;this.bGetTimeXXXExiste("_OnValideLigneZR")||(this.m_oValideLigneZR=new WDZRValideLigne(r,u,i),this.nSetTimeoutUnique("_OnValideLigneZR",clWDUtil.ms_oTimeoutImmediat))},WDZR.prototype._OnValideLigneZR=function(){var n=this.m_oValideLigneZR;this.m_oValideLigneZR=null,delete this.m_oValideLigneZR,this.__OnValideLigneZR(n)},WDZR.prototype.__OnValideLigneZR=function(n){if(!1!=n.m_bChangement){var t=n.m_sContenu;t&&t.length>0&&this.m_oCache.CreeRequeteModifLigne(this,n.m_nLigneAbsolue,!0,t)}},WDZR.prototype.__sGetContenuLigne=function(n){var t=clWDUtil.tabGetElements(document.getElementById(n),!1);return clWDAJAXMain.sConstruitValeurPage(t)},WDZR.prototype.bEstLienOuImageDansLien=function(n){if(!n)return!1;var t=bIE?n.srcElement:n.target;switch(clWDUtil.sGetTagName(t)){case"img":return clWDUtil.bBaliseEstTag(t.parentNode,"a");case"a":return!0;default:return!1}},WDZR.prototype.OnFocusLigneZR=function(n,t){var u=t[0],i=t[1],f=t[2],r;if(this.bGetTimeXXXExiste("_OnValideLigneZR")&&this.m_oValideLigneZR.m_sCelluleId==u&&this.m_oValideLigneZR.m_nLigneAbsolue==i){this.m_bChangementValideLigneZRSuivant=this.m_oValideLigneZR.m_bChangement,this.bEstLienOuImageDansLien(n)&&(this.m_bValideLigneZRCelluleDansLien=!0),this.AnnuleTimeXXX("_OnValideLigneZR"),this.m_oValideLigneZR=null,delete this.m_oValideLigneZR;return}r=0,this.m_bSansLimite||(i==this.m_nDebut&&parseInt(this.m_oDivPos.style.top,10)<0?r=parseInt(this.m_oDivPos.style.top,10):i>=this.m_nDebut+this.m_nNbLignesPage&&(r=parseInt(this.m_oAscenseur.style.height,10)/(this.m_nNbLignes/this.vnGetNbLignesLogiquesParLignePhysique()))),this.nSetTimeout(this.DonneFocusZR,clWDUtil.ms_nTimeoutNonImmediat20,r,i,f)},WDZR.prototype._sGetIDCellule=function(n){return this.oGetIDCelluleRel(n.vnGetLigneHTML(this.m_nDebut)-this.nGetLigneHTMLDebut(),n.vnGetColonneHTML()).id},WDZR.prototype.DonneFocusZR=function(n,t,i){n!=0&&this.__nForceDefilement(n,null,!1);var u=this.m_oCache.oGetLigne(t),f=this._sGetIDCellule(u),r=clWDUtil.tabGetElements(document.getElementById(f),!1);if(r&&r[i])try{clWDUtil.DonneFocus(r[i])}catch(e){}},WDZR.prototype.OnSelectLigne=function(n,t,i){if(!(this.m_oCache.m_tabRequetes.length>0)){var r=n+this.m_nDebut;this.bLigneEstSelectionnee(r)||(this.bLigneDeselectionneTous(-1,i),this.__bLigneSelectionne(r,!0,i))}},WDZR.prototype._vMasqueLigneInterne=function(n,t,i){WDTable.prototype._vMasqueLigneInterne.apply(this,arguments),this.m_tabChampsFils._AppelMethodePtr(WDChamp.prototype.OnLigneZRMasque,[n+1,t,i])},WDZR.prototype.vPreMAJLigne=function(n,t){this._vMasqueLigneInterne(n,this.bLigneEstSelectionnee(n),t)},WDZR.prototype.vPostMAJLigne=function(n){this.m_tabChampsFils._AppelMethodePtr(WDChamp.prototype.OnLigneZRAffiche,[n+1,this.bLigneEstSelectionnee(n)])}