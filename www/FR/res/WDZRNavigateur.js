/*! VersionVI: 30F180062h x */
function WDZRLigne(n){n!==undefined&&(this.m_tabValeurs=new Array(n),this.m_nDeroule=this.ms_nTous,this.m_nRupturesHaut=this.ms_nRien,this.m_nRupturesBas=this.ms_nRien,this.m_bPCodeAffichage=!1,this.m_bModifieRuptures=!0)}function WDZRRupture(n,t,i,r,u,f){n&&(this.m_sAlias=n,this.m_nColonne=t,this.m_oPCodesHaut=new WDPCodes(i),this.m_oPCodesBas=new WDPCodes(r),this.m_bVisibleHaut=u,this.m_bVisibleBas=f)}function WDZRColonne(n,t,i){n&&(this.m_sAlias=n,this.m_eProprieteAssocie=t,this.m_nType=undefined!==i?i:16)}function WDZRNavigateur(n,t,i){n&&(WDChampParametresHote.prototype.constructor.apply(this,[n,undefined,undefined]),this.m_tabLignes=[],this.m_tabColonnes=[],this.m_tabRuptures=[],this.m_tabTri=[],this.m_tabCouleurFond=t,this.m_nNbLignesLogiquesParLignePhysique=i,this.m_tabChampsFils=new WDTableauChamps,this.ms_tabTablesZRs.DeclareChamp(this))}WDZRLigne.prototype.ms_nRien=0,WDZRLigne.prototype.ms_nTous=4294967295|0,WDZRLigne.prototype.tabGetValeurs=function(){return this.m_tabValeurs},WDZRLigne.prototype.SetModifieRuptures=function(n){this.m_bModifieRuptures=this.m_bModifieRuptures||n},WDZRLigne.prototype.bGetClearPCodeAffichage=function(){var n=this.m_bPCodeAffichage;return this.m_bPCodeAffichage=!0,!n},WDZRLigne.prototype.bGetClearModifieRuptures=function(){var n=this.m_bModifieRuptures;return this.m_bModifieRuptures=!1,n},WDZRLigne.prototype.nGetRuptures=function(n){return n?this.m_nRupturesHaut:this.m_nRupturesBas},WDZRLigne.prototype.bGetRupture=function(n,t){return this.bGetRuptureDirect(n,t)||0<n&&this.bGetRupture(n-1,t)},WDZRLigne.prototype.bGetRuptureDirect=function(n,t){return 0!=(this.nGetRuptures(t)&1<<n)},WDZRLigne.prototype.bGetRuptureVisible=function(n,t){if(!this.bGetDeroule())if(t){for(var i=n-1;0<=i;i--)if(0==(this.m_nDeroule&1<<i))return!1}else return!1;return this.bGetRupture(n,t)},WDZRLigne.prototype.bGetDeroule=function(){return this.ms_nTous==this.m_nDeroule},WDZRLigne.prototype.CopieEnrouleDeroule=function(n,t){var i=1<<t;0==(n.m_nDeroule&i)?this.m_nDeroule&=~i:this.m_nDeroule|=i},WDZRLigne.prototype.OnSupprime=function(){this.m_tabValeurs.length=0},WDZRLigne.prototype.EnrouleDeroule=function(n,t,i){var r=1<<n;t===undefined&&(t=0==(this.m_nDeroule&r)),t?(this.m_nDeroule|=r,i&&0<n&&this.EnrouleDeroule(n-1,t,i)):this.m_nDeroule&=~r},WDZRLigne.prototype.SetRupturesHaut=function(n){var t=this.m_nRupturesHaut^n;this.m_nRupturesHaut=n,this.m_nDeroule|=t},WDZRLigne.prototype.SetRupturesBas=function(n){this.m_nRupturesBas=n},WDZRRupture.prototype.RecuperePCode=function(n,t){return(t?this.m_oPCodesHaut:this.m_oPCodesBas).RecuperePCode(n)},WDZRRupture.prototype.bVisible=function(n){return n?this.m_bVisibleHaut:this.m_bVisibleBas},WDZRColonne.prototype.oGetValeurInterne=function(n){if(n!==undefined){var t;switch(this.m_eProprieteAssocie){case WDChamp.prototype.XML_CHAMP_PROP_NUM_VISIBLE:case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICEGRAS:case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICEITALIQUE:case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICESOULIGNE:return!1!=n&&"false"!=n;case WDChamp.prototype.XML_CHAMP_PROP_NUM_ETAT:return t=parseInt(n+"",10),t!=WDChamp.prototype.ms_eEtatActif&&t!=WDChamp.prototype.ms_eEtatLectureSeule&&t!=WDChamp.prototype.ms_eEtatGrise&&(t=WDChamp.prototype.ms_eEtatActif),t;case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICETAILLE:default:switch(typeof n){case"boolean":return n;default:return clWDUtil.oConversionType(n,this.m_nType)}}}else return this.__oGetValeurDefaut()},WDZRColonne.prototype.__oGetValeurDefaut=function(){switch(this.m_eProprieteAssocie){case WDChamp.prototype.XML_CHAMP_PROP_NUM_VISIBLE:return!0;case WDChamp.prototype.XML_CHAMP_PROP_NUM_ETAT:return WDChamp.prototype.ms_eEtatActif;case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICEGRAS:case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICEITALIQUE:case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICESOULIGNE:return!1;case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICETAILLE:return 0;default:return""}},WDZRColonne.prototype.fGetCompare=function(n){return n?this.nCompareChaineCommencePar:this.nCompareChaine},WDZRColonne.prototype.nCompareChaine=function(n,t){return n<t?-1:n>t?1:0},WDZRColonne.prototype.nCompareChaineCommencePar=function(n,t){var i=Math.min(n.length,t.length);return this.nCompareChaine(n.substring(0,i),t.substring(0,i))},WDZRNavigateur.prototype=new WDChampParametresHote,WDZRNavigateur.prototype.constructor=WDZRNavigateur,WDZRNavigateur.prototype.ms_nLigneInvalide=-1,WDZRNavigateur.prototype.ms_sDynO="[%",WDZRNavigateur.prototype.ms_sDynF="%]",WDZRNavigateur.prototype.ms_sDynSi="[%SI%]",WDZRNavigateur.prototype.ms_sDynAlors="[%ALORS%]",WDZRNavigateur.prototype.ms_sDynFin="[%FIN%]",WDZRNavigateur.prototype.ms_sInclureHautRupture="INCLURE_HAUTRUPTURE",WDZRNavigateur.prototype.ms_sInclureBasRupture="INCLURE_BASRUPTURE",WDZRNavigateur.prototype.ms_sConditionEgal="=",WDZRNavigateur.prototype.ms_sConditionDifferent="!=",WDZRNavigateur.prototype.ms_sPropriete="..",WDZRNavigateur.prototype.ms_sConversion=";",WDZRNavigateur.prototype.ms_nAttributRuptureLigneDebut=-1,WDZRNavigateur.prototype.ms_nAttributRuptureLigneFin=-2,WDZRNavigateur.prototype.ms_nAttributLigneRepliee=-3,WDZRNavigateur.prototype.ms_nAttributIncludeHautRupture=-4,WDZRNavigateur.prototype.ms_nAttributIncludeBasRupture=-5,WDZRNavigateur.prototype.ms_nAttributLignePaire=-6,WDZRNavigateur.prototype.ms_nConversionPoliceGras=4,WDZRNavigateur.prototype.ms_nConversionPoliceItalique=5,WDZRNavigateur.prototype.ms_nConversionPoliceSouligne=6,WDZRNavigateur.prototype.Init=function(){WDChampParametresHote.prototype.Init.apply(this,arguments),this.__HTMLParse(),this.m_oChampDeb.value="1",this.m_oChampOcc.value="0",this.m_oChampFormulaire.value="0"},WDZRNavigateur.prototype.vbZR=function(){return!0},WDZRNavigateur.prototype.vZRDeclareChampFils=function(n){this.m_tabChampsFils.DeclareChamp(n)},WDZRNavigateur.prototype.vZROnSelectLigne=function(n){this._vSetValeurChampFormulaire(n)},WDZRNavigateur.prototype.vZROnValideLigne=function(n,t,i){if(t){var r=this._nGetColonneSelonAlias(t.m_sAliasAttribut);undefined!==r&&this.__OnLigneModifieFormulaire(n,[r,this._nGetSelection(),i])}},WDZRNavigateur.prototype._vLiaisonHTML=function(n,t){n="",WDChampParametresHote.prototype._vLiaisonHTML.apply(this,[n,t]),this.m_oChampDeb=this.oGetElementByName(document,"_DEB"),this.m_oChampOcc=document.getElementsByName("_"+this.m_sAliasChamp+"_OCC")[0]},WDZRNavigateur.prototype.DeclareColonne=function(n,t,i){this.m_tabColonnes.push(new WDZRColonne(n,t,i))},WDZRNavigateur.prototype.DeclareRupture=function(n,t,i,r,u,f){this.m_tabRuptures.push(new WDZRRupture(n,this._nGetColonneSelonAlias(t),i,r,u,f))},WDZRNavigateur.prototype._nGetNbLignes=function(){return this.m_tabLignes.length},WDZRNavigateur.prototype._nGetNbColonnes=function(){return this.m_tabColonnes.length},WDZRNavigateur.prototype._nGetNbRuptures=function(){return this.m_tabRuptures.length},WDZRNavigateur.prototype.__s_bCompareAlias=function(n,t){return n.m_sAlias==t},WDZRNavigateur.prototype.__nDansTableauAlias=function(n,t){var i=clWDUtil.nDansTableauFct(n,this.__s_bCompareAlias,t);return clWDUtil.nElementInconnu!=i?i:undefined},WDZRNavigateur.prototype._nGetRuptureSelonAlias=function(n){return this.__nDansTableauAlias(this.m_tabRuptures,n)},WDZRNavigateur.prototype._nGetColonneSelonAlias=function(n){return this.__nDansTableauAlias(this.m_tabColonnes,n)},WDZRNavigateur.prototype.__RupturesEntreLignes=function(n,t,i,r){var u,s=this.m_tabRuptures,o,e;if(n&&t){u=WDZRLigne.prototype.ms_nRien;for(var h=n.tabGetValeurs(),c=t.tabGetValeurs(),l=this._nGetNbRuptures(),f=0;f<l;f++)o=s[f].m_nColonne,h[o]!=c[o]&&(u|=1<<f)}else u=WDZRLigne.prototype.ms_nTous;n&&(e=n.nGetRuptures(!1),n.SetRupturesBas(u),this.__AppelPCodeAffichageRuptures(i,u,e,!1)),t&&(e=t.nGetRuptures(!0),t.SetRupturesHaut(u),this.__AppelPCodeAffichageRuptures(r,u,e,!0))},WDZRNavigateur.prototype.__OnLigneModificationRuptures=function(n){-1==n&&(n=0);var t=this.m_tabLignes[n];t&&t.SetModifieRuptures(!0)},WDZRNavigateur.prototype.__OnLigneModification=function(n,t,i){this.__OnLigneModificationRuptures(n-1),this.__OnLigneModificationRuptures(n),this._LigneAffiche(n,t,i)},WDZRNavigateur.prototype.__LigneModifie=function(n,t){for(var u=this.m_tabLignes[t].tabGetValeurs(),r=this.m_tabColonnes,f=r.length,i=0;i<f;i++)u[i]=r[i].oGetValeurInterne(n[i]);this.__OnLigneModification(t)},WDZRNavigateur.prototype.__OnLigneModifieFormulaire=function(n,t){var u=t[0],f=t[1],r,i;if(2<t.length)r=this.m_tabColonnes[u].oGetValeurInterne(t[2]);else{i=bIE?n.srcElement:n.target,r=i.value;switch(i.type.toLowerCase()){case"checkbox":r=i.checked?!0:!1;break;case"radio":if(!i.checked)return;break;case"select-multiple":case"select-one":r=i.selectedIndex!=-1?parseInt(i.options[i.selectedIndex].value,10):-1}}this.m_tabLignes[f].tabGetValeurs()[u]=r,this.__OnLigneModification(f,undefined,0==this._nGetNbRuptures())},WDZRNavigateur.prototype.__SetOnBlurChange=function(){for(var f=clWDUtil.tabGetElements(this.m_oHote,!1),o=f.length,t,i,r,u,e,n=0;n<o;n++)t=f[n],i=[],clWDUtil.bEstAliasAttributZR(t,i)&&(r=this._nLigneWLLigne(i[0]),u=this._nGetColonneSelonAlias(i[1]),r!==undefined&&u!==undefined&&(e=t.onchange!==undefined?"onchange":"onblur",clWDUtil.SetOnXxx(t,e,this,this.__OnLigneModifieFormulaire,[u,r],!0)))},WDZRNavigateur.prototype.__LigneAfficheCalculs=function(n){for(var r=this.m_tabLignes,u=this._nGetNbLignes(),e=this.RecuperePCode(this.ms_nEventNavAffichageLigne),i,f,t=n;t<u;t++)r[t].bGetClearPCodeAffichage()&&this.__AppelPCodeAffichage(t,e);if(0<this._nGetNbRuptures())for(t=0<n?n-1:n;t<u;t++)i=r[t],i.bGetClearModifieRuptures()&&(t==0&&this.__RupturesEntreLignes(undefined,i,undefined,0),f=t<u-1?r[t+1]:undefined,this.__RupturesEntreLignes(i,f,t,t+1))},WDZRNavigateur.prototype.__AppelPCodeAffichage=function(n,t){if(t!=clWDUtil.m_pfVide)try{this.m_sAliasZR=this.m_sAliasChamp,this.m_nPCodeAffichageLigne=n,this.oAppelSurLigneZR(n+1,t,[])}finally{delete this.m_nPCodeAffichageLigne,delete this.m_sAliasZR}},WDZRNavigateur.prototype.__AppelPCodeAffichageRuptures=function(n,t,i,r){for(var f=this.m_tabRuptures,e=f.length,u=0;u<e;u++)t&1<<u&&this.__AppelPCodeAffichage(n,f[u].RecuperePCode(this.ms_nEventNavAffichageLigne,r))},WDZRNavigateur.prototype.__LigneAffiche=function(n){var i,u,r,o;this.__LigneAfficheCalculs(n);try{i=document.activeElement,i&&clWDUtil.bEstFils(i,this.m_oHote,document)&&(this.m_sFocusNom=i.name,this.m_sFocusNom&&this.m_sFocusNom.length&&(this.m_nFocusIndice=clWDUtil.nDansTableau(document.getElementsByName(this.m_sFocusNom),i),clWDUtil.nElementInconnu==this.m_nFocusIndice&&(this.m_nFocusIndice=0)))}catch(h){}clWDUtil.SupprimeFilsEtOnFocus(this.m_oHote,!1);for(var f=[],s=this.m_tabLignes,e=this._nGetNbLignes(),t=0;t<e;t++)this.__HTMLGenere(t,s[t],this.m_tabElementsHTML,f);for(bIE&&clWDUtil.bBaliseEstTag(this.m_oHote,"table")?(u=(this.m_oHote.outerHTML+"").split("><"),this.m_oHote.outerHTML=u[0]+">"+f.join("")+"<"+u[u.length-1]):this.m_oHote.innerHTML=f.join(""),this._vLiaisonHTML(),this.__SetOnBlurChange(),bIEQuirks&&(r=_JGE(this.m_sAliasChamp,document,!0,!1),r&&clWDUtil.oGetCurrentStyle(r).position=="absolute"&&(r.className=r.className)),o=this._nGetSelection(),t=0;t<e;t++)this.m_tabChampsFils._AppelMethodePtr(WDChamp.prototype.OnLigneZRAffiche,[t+1,t==o]);this.m_nFocusIndice!==undefined&&this.nSetTimeoutUnique("__SetFocus",clWDUtil.ms_oTimeoutImmediat)},WDZRNavigateur.prototype.__SetFocus=function(){if(this.m_nFocusIndice!==undefined){try{document.getElementsByName(this.m_sFocusNom)[this.m_nFocusIndice].focus()}catch(n){}delete this.m_nFocusIndice,delete this.m_sFocusNom}},WDZRNavigateur.prototype.__Montre=function(){},WDZRNavigateur.prototype.__OnLigneSupprime=function(n){this.m_tabLignes[n].OnSupprime(),this.m_tabLignes[n]=null},WDZRNavigateur.prototype.__LigneSupprime=function(n){this.__OnLigneSupprime(n),this.m_tabLignes.splice(n,1),this.m_oChampOcc.value=this._nGetNbLignes(),this.__OnLigneModificationRuptures(n-1)},WDZRNavigateur.prototype.__LigneSupprimeTout=function(){for(var t=this._nGetNbLignes(),n=0;n<t;n++)this.__OnLigneSupprime(n);this.m_tabLignes.length=0,this.m_oChampOcc.value=this._nGetNbLignes(),this._LigneAffiche(0)},WDZRNavigateur.prototype.__nTriCompare=function(n,t){for(var f=this.m_tabTri,e=n.tabGetValeurs(),o=t.tabGetValeurs(),s=this.m_tabColonnes,h=f.length,i,u,r=0;r<h;r++)if(i=f[r],u=i.m_fCompare.apply(s[i.m_nColonne],[e[i.m_nColonne],o[i.m_nColonne]]),0!=u)return i.m_bCroissant?u:-u;return 0},WDZRNavigateur.prototype.__nLigneCherche=function(n,t,i,r){for(var f=this.m_tabColonnes[n],e=f.oGetValeurInterne(t),o=f.fGetCompare(i),s=this.m_tabLignes,h=this._nGetNbLignes(),u=r;u<h;u++)if(0==o.apply(f,[e,this.__oGetValeurColonne(n,s[u])]))return u;return this.ms_nLigneInvalide},WDZRNavigateur.prototype.__sLitPropriete=function(n,t,i,r,u){switch(i){case this.XML_CHAMP_PROP_NUM_VALEUR:return this._nLigneLigneWL(n);case this.XML_CHAMP_PROP_NUM_COULEURFOND:if(t.m_sCouleurFond!==undefined)return t.m_sCouleurFond;var f=-1;return this.m_tabCouleurFond&&this.m_tabCouleurFond.length&&(f=this.m_tabCouleurFond[n%this.m_tabCouleurFond.length]),f!=-1||u||(f="transparent"),f;case this.ms_nAttributRuptureLigneDebut:return n%this.m_nNbLignesLogiquesParLignePhysique==0;case this.ms_nAttributRuptureLigneFin:return n%this.m_nNbLignesLogiquesParLignePhysique==this.m_nNbLignesLogiquesParLignePhysique-1;case this.ms_nAttributLigneRepliee:return!1==this.m_tabLignes[n].bGetDeroule();case this.ms_nAttributIncludeHautRupture:return this.__bGetRuptureVisible(n,r,!0);case this.ms_nAttributIncludeBasRupture:return this.__bGetRuptureVisible(n,r,!1);case this.ms_nAttributLignePaire:return 1==n%2;default:return""}},WDZRNavigateur.prototype.__bGetRuptureVisible=function(n,t,i){return this.m_tabRuptures[t].bVisible(i)?this.m_tabLignes[n].bGetRuptureVisible(t,i):!1},WDZRNavigateur.prototype._oGetValeurColonne=function(n,t){return this.__oGetValeurColonne(n,this.m_tabLignes[t])},WDZRNavigateur.prototype.__oGetValeurColonne=function(n,t){return t.tabGetValeurs()[n]},WDZRNavigateur.prototype._LigneModifie=function(n,t){var i=this._nLigneWLLigne(t,this._nGetSelection());i!==undefined&&this.__LigneModifie(n,i)},WDZRNavigateur.prototype._nLigneInsere=function(n,t,i){var u=this._nLigneWLLigne(i),f=new WDZRLigne(this._nGetNbColonnes()),r,e,s,o;if(u!==undefined?this.m_tabLignes.splice(u,0,f):(this.m_tabLignes.push(f),u=this._nGetNbLignes()-1),this.m_oChampOcc.value=this._nGetNbLignes(),this.__LigneModifie(t,u),n){if(this._TriEncore(),this.m_tabLignes[u]!=f)for(e=this._nGetNbLignes(),r=0;r<e;r++)if(this.m_tabLignes[r]==f){u=r;break}this.__LigneModifie(t,u)}if(e=this._nGetNbRuptures(),0<e){if(0<u)for(s=this.m_tabLignes[u-1],r=0;r<e;r++)if(f.bGetRuptureDirect(r,!0))break;else f.CopieEnrouleDeroule(s,r);if(u<this._nGetNbLignes()-1)for(o=this.m_tabLignes[u+1],r=0;r<e;r++)if(o.bGetRuptureDirect(r,!0))break;else f.CopieEnrouleDeroule(o,r)}return this._nLigneLigneWL(u)},WDZRNavigateur.prototype._LigneAffiche=function(n,t,i){if(!i&&this.m_nPCodeAffichageLigne===undefined){var r=n+(0<n?-1:0);this.m_nLigneAfficheSuivante=this.m_nLigneAfficheSuivante===undefined?r:Math.min(r,this.m_nLigneAfficheSuivante),t&&(this.m_bLigneMontreSuivante=t,this.m_nLigneMontreSuivante=n),this.nSetTimeoutUnique("_Affiche",clWDUtil.ms_oTimeoutImmediat)}},WDZRNavigateur.prototype._Affiche=function(){this.AnnuleTimeXXX("_Affiche",!1),this.__LigneAffiche(this.m_nLigneAfficheSuivante),this.m_bLigneMontreSuivante&&this.__Montre(this.m_nLigneMontreSuivante)},WDZRNavigateur.prototype._nLigneDeplace=function(n,t,i,r){var u=this.m_tabLignes,f=u[n];return i?(u[n]=u[t],u[t]=f,this.__OnLigneModification(n),this.__OnLigneModification(t,r)):(u.splice(n,1),n<t&&t--,u.splice(t,0,f),this.__OnLigneModification(t,r),this.__OnLigneModificationRuptures(n-1)),this._nLigneLigneWL(t)},WDZRNavigateur.prototype._LigneSupprime=function(n){this.__LigneSupprime(n)},WDZRNavigateur.prototype._LigneSupprimeTout=function(){this.__LigneSupprimeTout()},WDZRNavigateur.prototype._nGetSelection=function(){return this._nLigneWLLigne(this.m_oChampFormulaire.value)},WDZRNavigateur.prototype._nIndiceRupture=function(n,t){var r=this._nGetRuptureSelonAlias(n),u,i;if(r!==undefined)for(u=this.m_tabLignes,i=t;0<=i;i--)if(u[i].bGetRupture(r,!0))return this._nLigneLigneWL(i);return this.ms_nLigneInvalide},WDZRNavigateur.prototype._Tri=function(n){var e,i,t,u,o,r,f;this._TriAnnule(),e=this.m_tabColonnes,i=!0;switch(n){case"-":i=!1;case"+":for(u=this._nGetNbColonnes(),t=0;t<u;t++)this.m_tabTri.push({m_fCompare:e[t].fGetCompare(!0),m_nColonne:t,m_bCroissant:i});break;default:for(o=n.split("\t"),u=o.length,t=0;t<u;t++){r=o[t],i=!0;switch(r.substring(0,1)){case"-":i=!1;case"+":r=r.substring(1)}f=this._nGetColonneSelonAlias(r),f!==undefined&&this.m_tabTri.push({m_fCompare:e[f].fGetCompare(!0),m_nColonne:f,m_bCroissant:i})}}this._TriEncore()},WDZRNavigateur.prototype._TriEncore=function(){if(0<this.m_tabTri.length){var n=this;this.m_tabLignes.sort(function(){return n.__nTriCompare(arguments[0],arguments[1])})}},WDZRNavigateur.prototype._TriAnnule=function(){this.m_tabTri=[]},WDZRNavigateur.prototype._nLigneCherche=function(n,t,i,r){var u=this._nGetColonneSelonAlias(n),f=this.ms_nLigneInvalide;return u!==undefined&&(f=this.__nLigneCherche(u,t,i,r)),this._nLigneLigneWL(f)},WDZRNavigateur.prototype._EnrouleDerouleI=function(n,t,i,r,u){var o=this.m_tabLignes[n],s,f,h,e;if(this.__RupturesEntreLignes(this.m_tabLignes[n-1],o,n-1,n),o.bGetRupture(t,!0)){for(o.EnrouleDeroule(t,i,r),s=o,h=this._nGetNbLignes(),f=n+1;f<h;f++)if(e=this.m_tabLignes[f],this.__RupturesEntreLignes(s,e,f-1,f),e.bGetRupture(t,!0))break;else e.EnrouleDeroule(t,i,r),s=e;u&&this._LigneAffiche(n)}},WDZRNavigateur.prototype._EnrouleDeroule=function(n,t,i){var f=this._nLigneWLLigne(n,this._nGetSelection()),r,u;f!==undefined&&(t===undefined?(r=0<this._nGetNbRuptures()?0:undefined,u=!0):(r=this._nGetRuptureSelonAlias(t),u=!1),r!==undefined&&0<=r&&this._EnrouleDerouleI(f,r,i,u,!0))},WDZRNavigateur.prototype._EnrouleDerouleTout=function(n){for(var u=this._nGetNbLignes(),i,r,t=0;t<u;t++)for(r=this._nGetNbRuptures(),i=0;i<r;i++)this._EnrouleDerouleI(t,i,n,!0,!1);this._LigneAffiche(0)},WDZRNavigateur.prototype._nLigneWLLigne=function(n,t,i,r){return r&&n===-1?n=this._nGetSelection():n===undefined?n=t:(n=parseInt(n,10),isNaN(n)||n--),n!==undefined?!isNaN(n)&&this._nGetNbLignes()>n&&0<=n?n:i:n},WDZRNavigateur.prototype._nLigneLigneWL=function(n){return this.ms_nLigneInvalide!=n?n+1:this.ms_nLigneInvalide},WDZRNavigateur.prototype.Ajoute=function(n){return this.ms_nLigneInvalide!=this._nLigneInsere(!0,(""+n).split("\t"))},WDZRNavigateur.prototype.AjouteLigne=function(){return this._nLigneInsere(!0,this.__tabArgumentsVersTableau(arguments,0))},WDZRNavigateur.prototype.Modifie=function(n,t){this._LigneModifie((""+n).split("\t"),t)},WDZRNavigateur.prototype.ModifieLigne=function(n){this._LigneModifie(this.__tabArgumentsVersTableau(arguments,1),n)},WDZRNavigateur.prototype.Insere=function(n,t){return this.ms_nLigneInvalide!=this._nLigneInsere(!1,(""+n).split("\t"),t)},WDZRNavigateur.prototype.InsereLigne=function(n){this._nLigneInsere(!1,this.__tabArgumentsVersTableau(arguments,1),n)},WDZRNavigateur.prototype.DeplaceLigne=function(n,t,i){var r=this._nLigneWLLigne(n,undefined,undefined,!0),u=this._nLigneWLLigne(t,undefined,undefined,!0);return r!==undefined&&u!==undefined&&r!=u?this._nLigneDeplace(r,u,0!=(i&2147483648),0!=(i&65536)):0},WDZRNavigateur.prototype.Supprime=function(n){var t=this._nLigneWLLigne(n,this._nGetSelection());t!==undefined&&this._LigneSupprime(t)},WDZRNavigateur.prototype.SupprimeTout=function(){this._LigneSupprimeTout()},WDZRNavigateur.prototype.Occurrence=function(n){n===undefined&&(n=1);switch(n){case 1:return this._nGetNbLignes();case 2:return this._nGetNbColonnes();default:return this.ms_nLigneInvalide}},WDZRNavigateur.prototype.IndiceRupture=function(n,t){var i=this._nLigneWLLigne(t,this._nGetSelection());return i!==undefined?this._nIndiceRupture(n,i):this.ms_nLigneInvalide},WDZRNavigateur.prototype.Trie=function(n,t){t?this._Tri(n):this._TriAnnule()},WDZRNavigateur.prototype.Cherche=function(n,t,i,r){var u=this._nLigneWLLigne(r,0,0);return this._nLigneCherche(n,t,0==i,u)},WDZRNavigateur.prototype.Enroule=function(n,t){this._EnrouleDeroule(n,t,!1)},WDZRNavigateur.prototype.EnrouleTout=function(){this._EnrouleDerouleTout(!1)},WDZRNavigateur.prototype.Deroule=function(n,t){this._EnrouleDeroule(n,t,!0)},WDZRNavigateur.prototype.DerouleTout=function(){this._EnrouleDerouleTout(!0)},WDZRNavigateur.prototype.EnrouleDeroule=function(n,t){this._EnrouleDeroule(n,t)},WDZRNavigateur.prototype.oGetValeurColonne=function(n,t){var i=this._nLigneWLLigne(t,this._nGetSelection()),r=this._nGetColonneSelonAlias(n);return r!==undefined&&i!==undefined?this._oGetValeurColonne(r,i):""},WDZRNavigateur.prototype.tabGetLigneSet=function(n){var t=this._nLigneWLLigne(n,this._nGetSelection());return t!==undefined?(this.__OnLigneModification(t),this.m_tabLignes[t].tabGetValeurs()):[]},WDZRNavigateur.prototype.OnChange=function(){this.m_nPCodeAffichageLigne===undefined&&this._Affiche()},WDZRNavigateur.prototype.__HTMLParse=function(){this.m_tabElementsHTML=[];var n=clWDUtil.sGetHTMLDansCommentaire(this.m_oHote);this.__nHTMLParseInterne(n,0,this.m_tabElementsHTML)},WDZRNavigateur.prototype.__nHTMLParseInterne=function(n,t,i){for(;;){var r=n.indexOf(this.ms_sDynO,t);if(t=this.__nHTMLParseFixe(n,t,r,i),-1==r)return t;if(n.substr(r,this.ms_sDynFin.length)==this.ms_sDynFin)return r+this.ms_sDynFin.length;t=n.substr(r,this.ms_sDynSi.length)==this.ms_sDynSi?this.__nHTMLParseSi(n,r,i):this.__nHTMLParsePropriete(n,r,i)}},WDZRNavigateur.prototype.__nHTMLParseFixe=function(n,t,i,r){var u;return u=-1!=i?n.substring(t,i):n.substring(t),u.length>0&&r.push({vVersHTML:this.VersHTML_Fixe,m_sValeur:u}),t+u.length},WDZRNavigateur.prototype.__nHTMLParseSi=function(n,t,i){var r={vVersHTML:this.VersHTML_Condition,m_sValeur:"",m_bDifferent:!1,m_tabElementsHTML:[],m_oPropriete:null};t+=this.ms_sDynSi.length;var o=n.indexOf(this.ms_sDynAlors,t),f=n.substring(t,o),u=f.indexOf(this.ms_sConditionDifferent),e;return-1==u?(u=f.indexOf(this.ms_sConditionEgal),e=u+this.ms_sConditionEgal.length,r.m_bDifferent=!1):(e=u+this.ms_sConditionDifferent.length,r.m_bDifferent=!0),-1!=e&&(r.m_oPropriete=this.__oParsePropriete(f.substring(0,u)),r.m_sValeur=f.substring(e,o),i.push(r)),this.__nHTMLParseInterne(n,o+this.ms_sDynAlors.length,r.m_tabElementsHTML)},WDZRNavigateur.prototype.__nHTMLParsePropriete=function(n,t,i){t+=this.ms_sDynO.length;var r=n.indexOf(this.ms_sDynF,t);return i.push({vVersHTML:this.VersHTML_Propriete,m_oPropriete:this.__oParsePropriete(n.substring(t,r))}),r+this.ms_sDynF.length},WDZRNavigateur.prototype.__oParsePropriete=function(n){var t={m_ePropriete:this.XML_CHAMP_PROP_NUM_VALEUR},u=n.indexOf(this.ms_sConversion),i,r;return-1!=u&&(t.m_eConversion=parseInt(n.substring(u+this.ms_sConversion.length),10),n=n.substring(0,u)),i=n.indexOf(this.ms_sPropriete),-1!=i&&(r=[],t.m_ePropriete=this.__eParsePPPropriete(n.substring(i+this.ms_sPropriete.length),r),r[0]!==undefined&&(t.m_nParametre=r[0]),n=n.substring(0,i)),t.m_nColonne=this._nGetColonneSelonAlias(n),t},WDZRNavigateur.prototype.__eParsePPPropriete=function(n,t){switch(n){case"COULEURFOND":return this.XML_CHAMP_PROP_NUM_COULEURFOND;case"RUPTURELIGNE_DEBUT":return this.ms_nAttributRuptureLigneDebut;case"RUPTURELIGNE_FIN":return this.ms_nAttributRuptureLigneFin;case"LIGNEREPLIEE":return this.ms_nAttributLigneRepliee;case"LIGNEPAIRE":return this.ms_nAttributLignePaire;default:return this.__bParsePPProprieteDouble(n,t,this.ms_sInclureHautRupture)?this.ms_nAttributIncludeHautRupture:this.__bParsePPProprieteDouble(n,t,this.ms_sInclureBasRupture)?this.ms_nAttributIncludeBasRupture:this.XML_CHAMP_PROP_NUM_VALEUR}},WDZRNavigateur.prototype.__bParsePPProprieteDouble=function(n,t,i){return n.substr(0,i.length)==i?(t[0]=parseInt(n.substr(i.length),10),!0):!1},WDZRNavigateur.prototype.__HTMLGenere=function(n,t,i,r){for(var f=i.length,u=0;u<f;u++)i[u].vVersHTML.apply(this,[n,t,i[u],r])},WDZRNavigateur.prototype.VersHTML_Fixe=function(n,t,i,r){r.push(i.m_sValeur)},WDZRNavigateur.prototype.VersHTML_Propriete=function(n,t,i,r){r.push(this.__sGetPropriete(n,t,i.m_oPropriete,!1))},WDZRNavigateur.prototype.VersHTML_Condition=function(n,t,i,r){var u=i.m_sValeur==this.__sGetPropriete(n,t,i.m_oPropriete,!0);(i.m_bDifferent?!u:u)&&this.__HTMLGenere(n,t,i.m_tabElementsHTML,r)},WDZRNavigateur.prototype.__sGetPropriete=function(n,t,i,r){var u;return u=i.m_nColonne!==undefined?this.__oGetValeurColonne(i.m_nColonne,t):this.__sLitPropriete(n,t,i.m_ePropriete,i.m_nParametre,r),this.__sConversion(u,i.m_eConversion)},WDZRNavigateur.prototype.__sConversion=function(n,t){if(t!==undefined)switch(t){case this.ms_nConversionPoliceGras:if(typeof n=="boolean")return n?"bold":"normal";break;case this.ms_nConversionPoliceItalique:if(typeof n=="boolean")return n?"italic":"normal";break;case this.ms_nConversionPoliceSouligne:if(typeof n=="boolean")return n?"underline":"none"}return n}